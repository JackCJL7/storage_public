(function(){function a(n,A){var w=0,D=!1,z=window.setInterval(function(){n()&&(window.clearInterval(z),A(D));50<w++&&(window.clearInterval(z),D=!0,A(D))},10)}function b(n){n=n.toLowerCase();return 0===n.indexOf("msie")&&0===n.indexOf("trident")?!1:(n=/(?:msie|rv:)\s?([\d\.]+)/.exec(n))&&10<=parseInt(n[1],10)?!0:!1}function c(n){n=(n||u.userAgent).toLowerCase();return(n=n.match(/android\s([0-9\.]*)/))?n[1]:!1}function e(n,A){function w(O){if(O){console.log("candicate "+O);var ba=Fa.exec(O);ba&&(ba=
ba[1],O=O.match(qa),void 0===z[ba]&&n(ba,O,!0),z[ba]=!0)}else n()}function D(){x.localDescription.sdp.split("\n").forEach(function(O){O&&0===O.indexOf("a=candidate:")&&w(O)})}if("undefined"!==typeof document&&"function"===typeof document.getElementById){var z={},C=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!C){C=document.getElementById("iframe");if(!C)return;C=C.contentWindow;C=C.RTCPeerConnection||C.mozRTCPeerConnection||C.webkitRTCPeerConnection}if(C){var ma=
null;"Chrome"===p.browser&&58>p.browser.version&&(ma={optional:[{RtpDataChannels:!0}]});var x=new C({iceServers:[]},ma);A&&(x.addStream?x.addStream(A):x.addTrack&&A.getTracks()[0]&&x.addTrack(A.getTracks()[0],A));x.onicecandidate=function(O){O.candidate&&O.candidate.candidate?w(O.candidate.candidate):w()};if(!A)try{x.createDataChannel("",{reliable:!1})}catch(O){}p.isPromisesSupported?x.createOffer().then(function(O){x.setLocalDescription(O).then(D)}):x.createOffer(function(O){x.setLocalDescription(O,
D,function(){})},function(){})}}}function g(n){if(Ga)if(!u.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(u.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!u.enumerateDevices&&u.enumerateDevices&&(u.enumerateDevices=u.enumerateDevices.bind(u)),u.enumerateDevices){fa=[];ha=[];ia=[];ja=[];va=wa=xa=ra=ya=!1;var A={};u.enumerateDevices(function(w){fa=[];ha=[];ia=[];ja=[];w.forEach(function(D){var z={},C;for(C in D)try{"function"!==typeof D[C]&&
(z[C]=D[C])}catch(ma){}A[z.deviceId+z.label+z.kind]||("audio"===z.kind&&(z.kind="audioinput"),"video"===z.kind&&(z.kind="videoinput"),z.deviceId||(z.deviceId=z.id),z.id||(z.id=z.deviceId),z.label?("videoinput"!==z.kind||va||(va=!0),"audioinput"!==z.kind||wa||(wa=!0)):(z.isCustomLabel=!0,z.label="videoinput"===z.kind?"Camera "+(ja.length+1):"audioinput"===z.kind?"Microphone "+(ha.length+1):"audiooutput"===z.kind?"Speaker "+(ia.length+1):"Please invoke getUserMedia once.","undefined"!==typeof p&&p.browser.isChrome&&
46<=p.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(z.label="HTTPs is required to get label of this "+z.kind+" device.")),"audioinput"===z.kind&&(ya=!0,-1===ha.indexOf(z)&&ha.push(z)),"audiooutput"===z.kind&&(ra=!0,-1===ia.indexOf(z)&&ia.push(z)),"videoinput"===z.kind&&(xa=!0,-1===ja.indexOf(z)&&ja.push(z)),fa.push(z),A[z.deviceId+
z.label+z.kind]=z)});"undefined"!==typeof p&&(p.MediaDevices=fa,p.hasMicrophone=ya,p.hasSpeakers=ra,p.hasWebcam=xa,p.isWebsiteHasWebcamPermissions=va,p.isWebsiteHasMicrophonePermissions=wa,p.audioInputDevices=ha,p.audioOutputDevices=ia,p.videoInputDevices=ja);n&&n()})}else n&&n();else n&&n()}var h="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",r="object"===typeof process&&"object"===typeof process.versions&&process.versions.node&&!process.browser;if(r){var v=
process.versions.node.toString().replace("v","");h="Nodejs/"+v+" (NodeOS) AppleWebKit/"+v+" (KHTML, like Gecko) Nodejs/"+v+" Nodejs/"+v}(function(n){"undefined"===typeof window&&("undefined"===typeof window&&"undefined"!==typeof global&&(global.navigator={userAgent:h,getUserMedia:function(){}},n.window=global),"undefined"===typeof location&&(n.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(n.screen={width:0,height:0}))})("undefined"!==typeof global?global:window);var u=
window.navigator;"undefined"!==typeof u?("undefined"!==typeof u.webkitGetUserMedia&&(u.getUserMedia=u.webkitGetUserMedia),"undefined"!==typeof u.mozGetUserMedia&&(u.getUserMedia=u.mozGetUserMedia)):u={getUserMedia:function(){},userAgent:h};v=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(u.userAgent||"");var M=-1!==u.userAgent.indexOf("Edge")&&(!!u.msSaveOrOpenBlob||!!u.msSaveBlob),P=!!window.opera||0<=u.userAgent.indexOf(" OPR/"),ka=-1<u.userAgent.toLowerCase().indexOf("firefox")&&
"netscape"in window&&/ rv:/.test(u.userAgent),sa=/^((?!chrome|android).)*safari/i.test(u.userAgent),na=!!window.chrome&&!P,W="undefined"!==typeof document&&!!document.documentMode&&!M,Q={Android:function(){return u.userAgent.match(/Android/i)},BlackBerry:function(){return u.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return u.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return u.userAgent.match(/Opera Mini/i)},Windows:function(){return u.userAgent.match(/IEMobile/i)},any:function(){return Q.Android()||
Q.BlackBerry()||Q.iOS()||Q.Opera()||Q.Windows()},getOsName:function(){var n="Unknown OS";Q.Android()&&(n="Android");Q.BlackBerry()&&(n="BlackBerry");Q.iOS()&&(n="iOS");Q.Opera()&&(n="Opera Mini");Q.Windows()&&(n="Windows");return n}},H="Unknown OS",V="Unknown OS Version";(r=function(){for(var n=u.appVersion,A=u.userAgent,w="-",D=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},
{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",
r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],z=0,C;C=D[z];z++)if(C.r.test(A)){w=C.s;break}D="-";/Windows/.test(w)&&(/Windows (.*)/.test(w)&&(D=/Windows (.*)/.exec(w)[1]),
w="Windows");switch(w){case "Mac OS X":/Mac OS X (10[\._\d]+)/.test(A)&&(D=/Mac OS X (10[\._\d]+)/.exec(A)[1]);break;case "Android":/Android ([\._\d]+)/.test(A)&&(D=/Android ([\._\d]+)/.exec(A)[1]);break;case "iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(A)&&(D=/OS (\d+)_(\d+)_?(\d+)?/.exec(n))&&3<D.length&&(D=D[1]+"."+D[2]+"."+(D[3]|0))}return{osName:w,osVersion:D}}())&&r.osName&&"-"!=r.osName?(H=r.osName,V=r.osVersion):Q.any()&&(H=Q.getOsName(),"Android"==H&&(V=c()));r="object"===typeof process&&"object"===
typeof process.versions&&process.versions.node;"Unknown OS"===H&&r&&(H="Nodejs",V=process.versions.node.toString().replace("v",""));var aa=!1,ca=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(n){"undefined"!==typeof document&&"function"===typeof document.createElement&&(!aa&&n in document.createElement("canvas")&&(aa=!0),!ca&&n in document.createElement("video")&&(ca=!0))});var qa=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,Fa=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,
Ka=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,fa=[],ha=[],ia=[],ja=[];u.mediaDevices&&u.mediaDevices.enumerateDevices&&(u.enumerateDevices=function(n){var A=u.mediaDevices.enumerateDevices();A&&A.then?u.mediaDevices.enumerateDevices().then(n).catch(function(){n([])}):n([])});var Ga=!1;"undefined"!==typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?Ga=!0:u.mediaDevices&&u.mediaDevices.enumerateDevices&&(Ga=!0);var ya=!1,ra=!1,xa=!1,wa=!1,va=!1,p=window.DetectRTC||{};p.browser=function(){var n=u.userAgent,
A=u.appName,w=""+parseFloat(u.appVersion);parseInt(u.appVersion,10);var D,z;if(P){A="Opera";try{w=u.userAgent.split("OPR/")[1].split(" ")[0],w.split(".")}catch(ma){w="0.0.0.0"}}else if(W){var C=n.indexOf("rv:");0<C?w=n.substring(C+3):(C=n.indexOf("MSIE"),w=n.substring(C+5));A="IE"}else na?(C=n.indexOf("Chrome"),A="Chrome",w=n.substring(C+7)):sa?-1!==n.indexOf("CriOS")?(C=n.indexOf("CriOS"),A="Chrome",w=n.substring(C+6)):-1!==n.indexOf("FxiOS")?(C=n.indexOf("FxiOS"),A="Firefox",w=n.substring(C+6)):
(C=n.indexOf("Safari"),A="Safari",w=n.substring(C+7),-1!==(C=n.indexOf("Version"))&&(w=n.substring(C+8)),-1!==u.userAgent.indexOf("Version/")&&(w=u.userAgent.split("Version/")[1].split(" ")[0])):ka?(C=n.indexOf("Firefox"),A="Firefox",w=n.substring(C+8)):(D=n.lastIndexOf(" ")+1)<(C=n.lastIndexOf("/"))&&(A=n.substring(D,C),w=n.substring(C+1),A.toLowerCase()===A.toUpperCase()&&(A=u.appName));M&&(A="Edge",w=u.userAgent.split("Edge/")[1]);-1!==(z=w.search(/[; \)]/))&&(w=w.substring(0,z));n=parseInt(""+
w,10);isNaN(n)&&(w=""+parseFloat(u.appVersion),n=parseInt(u.appVersion,10));return{fullVersion:w,version:n,name:A,isPrivateBrowsing:!1}}();(function(n){try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){w=!1},function(D){w=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){try{var A=window.indexedDB.open("test");A.onerror=function(){return!0}}catch(D){var w=!0}"undefined"===typeof w&&a(function(){return"done"===A.readyState?!0:
!1},function(D){D||(w=A.result?!1:!0)})}else if(b(window.navigator.userAgent)){w=!1;try{window.indexedDB||(w=!0)}catch(D){w=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(D){w=!0}"undefined"===typeof w&&(w=!1,window.localStorage.removeItem("test"))}}catch(D){w=!1}a(function(){return"undefined"!==typeof w?!0:!1},function(D){n(w)})})(function(n){p.browser.isPrivateBrowsing=!!n});p.browser["is"+p.browser.name]=!0;p.osName=H;
p.osVersion=V;var Ba=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(n){Ba||n in window&&(Ba=!0)});p.isWebRTCSupported=Ba;p.isORTCSupported="undefined"!==typeof RTCIceGatherer;H=!1;p.browser.isChrome&&35<=p.browser.version?H=!0:p.browser.isFirefox&&34<=p.browser.version?H=!0:p.browser.isEdge&&17<=p.browser.version?H=!0:"Android"===p.osName&&p.browser.isChrome&&(H=!0);if(u.getDisplayMedia||u.mediaDevices&&u.mediaDevices.getDisplayMedia)H=
!0;/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(p.browser.isChrome||p.browser.isEdge||p.browser.isOpera)?H=!1:p.browser.isFirefox&&(H=!1));p.isScreenCapturingSupported=H;var Ha=!1,Ia=!1;["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(n){!Ha&&n in window&&(Ha=!0,window[n]&&"createMediaStreamSource"in window[n].prototype&&
(Ia=!0))});p.isAudioContextSupported=Ha;p.isCreateMediaStreamSourceSupported=Ia;H=!1;p.browser.isChrome&&31<p.browser.version&&(H=!0);p.isRtpDataChannelsSupported=H;H=!1;p.browser.isFirefox&&28<p.browser.version?H=!0:p.browser.isChrome&&25<p.browser.version?H=!0:p.browser.isOpera&&11<=p.browser.version&&(H=!0);p.isSctpDataChannelsSupported=H;p.isMobileDevice=v;v=!1;u.getUserMedia?v=!0:u.mediaDevices&&u.mediaDevices.getUserMedia&&(v=!0);p.browser.isChrome&&46<=p.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||
"")&&"undefined"!==typeof document&&"string"===typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(v="Requires HTTPs");"Nodejs"===p.osName&&(v=!1);p.isGetUserMediaSupported=v;v="";screen.width&&(v+=""+(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));p.displayResolution=v;p.displayAspectRatio=function(n,A){function w(z,C){return 0==C?z:w(C,z%C)}var D=w(n,A);return n/D/(A/D)}(screen.width,screen.height).toFixed(2);p.isCanvasSupportsStreamCapturing=
aa;p.isVideoSupportsStreamCapturing=ca;"Chrome"==p.browser.name&&53<=p.browser.version&&(p.isCanvasSupportsStreamCapturing||(p.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),p.isVideoSupportsStreamCapturing||(p.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"));p.DetectLocalIPAddress=function(n,A){if(p.isWebRTCSupported){var w=!0,D=!0;e(function(z){z?z.match(qa)?(w=!1,n("Local: "+z,w,D)):(z.match(Ka)&&
(D=!1),n("Public: "+z,w,D)):n()},A)}};p.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING;p.isWebSocketsBlocked=!p.isWebSocketsSupported;"Nodejs"===p.osName&&(p.isWebSocketsSupported=!0,p.isWebSocketsBlocked=!1);p.checkWebSocketsSupport=function(n){n=n||function(){};try{var A,w=new WebSocket("wss://echo.websocket.org:443/");w.onopen=function(){p.isWebSocketsBlocked=!1;A=(new Date).getTime();w.send("ping")};w.onmessage=function(){p.WebsocketLatency=(new Date).getTime()-A+"ms";
n();w.close();w=null};w.onerror=function(){p.isWebSocketsBlocked=!0;n()}}catch(D){p.isWebSocketsBlocked=!0,n()}};p.load=function(n){g(n||function(){})};p.MediaDevices="undefined"!==typeof fa?fa:[];p.hasMicrophone=ya;p.hasSpeakers=ra;p.hasWebcam=xa;p.isWebsiteHasWebcamPermissions=va;p.isWebsiteHasMicrophonePermissions=wa;p.audioInputDevices=ha;p.audioOutputDevices=ia;p.videoInputDevices=ja;v=!1;"undefined"!==typeof document&&"function"===typeof document.createElement&&"setSinkId"in document.createElement("video")&&
(v=!0);p.isSetSinkIdSupported=v;v=!1;p.browser.isFirefox&&"undefined"!==typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(v=!0):p.browser.isChrome&&"undefined"!==typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(v=!0);p.isRTPSenderReplaceTracksSupported=v;v=!1;p.browser.isFirefox&&38<p.browser.version&&(v=!0);p.isRemoteStreamProcessingSupported=v;v=!1;"undefined"!==typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&
(v=!0);p.isApplyConstraintsSupported=v;v=!1;p.browser.isFirefox&&43<=p.browser.version&&(v=!0);p.isMultiMonitorScreenCapturingSupported=v;p.isPromisesSupported=!!("Promise"in window);p.version="1.4.1";"undefined"===typeof p&&(window.DetectRTC={});v=window.MediaStream;"undefined"===typeof v&&"undefined"!==typeof webkitMediaStream&&(v=webkitMediaStream);p.MediaStream="undefined"!==typeof v&&"function"===typeof v?Object.keys(v.prototype):!1;p.MediaStreamTrack="undefined"!==typeof MediaStreamTrack?Object.keys(MediaStreamTrack.prototype):
!1;v=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;p.RTCPeerConnection="undefined"!==typeof v?Object.keys(v.prototype):!1;window.DetectRTC=p;"undefined"!==typeof module&&(module.exports=p);"function"===typeof define&&define.amd&&define("DetectRTC",[],function(){return p})})();
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.anime=b()}(this,function(){function a(d,f,l){return Math.min(Math.max(d,f),l)}function b(d){return(d=/\(([^)]+)\)/.exec(d))?d[1].split(",").map(function(f){return parseFloat(f)}):[]}function c(d,f){function l(G){var K=f?f*G/1E3:G;return K=1>B?Math.exp(-K*B*F)*(1*Math.cos(I*K)+E*Math.sin(I*K)):(1+E*K)*Math.exp(-K*F),0===G||1===G?G:1-K}var k=b(d),m=a(x.und(k[0])?1:
k[0],.1,100),t=a(x.und(k[1])?100:k[1],.1,100),y=a(x.und(k[2])?10:k[2],.1,100);k=a(x.und(k[3])?0:k[3],.1,100);var F=Math.sqrt(t/m),B=y/(2*Math.sqrt(t*m)),I=1>B?F*Math.sqrt(1-B*B):0,E=1>B?(B*F-k)/I:-k+F;return f?l:function(){var G=ma.springs[d];if(G)return G;for(var K=G=0;;)if(1===l(G+=1/6)){if(16<=++K)break}else K=0;G=1/6*G*1E3;return ma.springs[d]=G,G}}function e(d){return void 0===d&&(d=10),function(f){return Math.ceil(a(f,1E-6,1)*d)*(1/d)}}function g(d,f){if(x.fnc(d))return d;var l=d.split("(")[0],
k=Ma[l],m=b(d);switch(l){case "spring":return c(d,f);case "cubicBezier":return Ra.apply(null,m);case "steps":return e.apply(null,m);default:return k.apply(null,m)}}function h(d){try{return document.querySelectorAll(d)}catch(f){}}function r(d,f){for(var l=d.length,k=2<=arguments.length?arguments[1]:void 0,m=[],t=0;t<l;t++)if(t in d){var y=d[t];f.call(k,y,t,d)&&m.push(y)}return m}function v(d){return d.reduce(function(f,l){return f.concat(x.arr(l)?v(l):l)},[])}function u(d){return x.arr(d)?d:(x.str(d)&&
(d=h(d)||d),d instanceof NodeList||d instanceof HTMLCollection?[].slice.call(d):[d])}function M(d,f){return d.some(function(l){return l===f})}function P(d){var f={},l;for(l in d)f[l]=d[l];return f}function ka(d,f){var l=P(d),k;for(k in d)l[k]=f.hasOwnProperty(k)?f[k]:d[k];return l}function sa(d,f){var l=P(d),k;for(k in f)l[k]=x.und(d[k])?f[k]:d[k];return l}function na(d){return x.rgb(d)?(l=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(f=d))?"rgba("+l[1]+",1)":f:x.hex(d)?(k=d.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,
function(t,y,F,B){return y+y+F+F+B+B}),m=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(k),"rgba("+parseInt(m[1],16)+","+parseInt(m[2],16)+","+parseInt(m[3],16)+",1)"):x.hsl(d)?function(t){function y(K,N,J){return 0>J&&(J+=1),1<J&&--J,J<1/6?K+6*(N-K)*J:.5>J?N:J<2/3?K+(N-K)*(2/3-J)*6:K}var F=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t);t=parseInt(F[1],10)/360;var B=parseInt(F[2],10)/100;var I=parseInt(F[3],10)/100;F=F[4]||1;if(0==
B)I=B=t=I;else{var E=.5>I?I*(1+B):I+B-I*B,G=2*I-E;I=y(G,E,t+1/3);B=y(G,E,t);t=y(G,E,t-1/3)}return"rgba("+255*I+","+255*B+","+255*t+","+F+")"}(d):void 0;var f,l,k,m}function W(d){if(d=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(d))return d[1]}function Q(d,f){return x.fnc(d)?d(f.target,f.id,f.total):d}function H(d,f,l){if(M([l,"deg","rad","turn"],W(f)))return f;var k=ma.CSS[f+l];if(!x.und(k))return k;k=document.createElement(d.tagName);
d=d.parentNode&&d.parentNode!==document?d.parentNode:document.body;d.appendChild(k);k.style.position="absolute";k.style.width=100+l;var m=100/k.offsetWidth;d.removeChild(k);k=m*parseFloat(f);return ma.CSS[f+l]=k,k}function V(d,f,l){if(f in d.style){var k=f.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();f=d.style[f]||getComputedStyle(d).getPropertyValue(k)||"0";return l?H(d,f,l):f}}function aa(d,f){return x.dom(d)&&!x.inp(d)&&(!x.nil(d.getAttribute(f))||x.svg(d)&&d[f])?"attribute":x.dom(d)&&M(C,
f)?"transform":x.dom(d)&&"transform"!==f&&V(d,f)?"css":null!=d[f]?"object":void 0}function ca(d){if(x.dom(d)){for(var f=d.style.transform||"",l=/(\w+)\(([^)]*)\)/g,k=new Map;d=l.exec(f);)k.set(d[1],d[2]);return k}}function qa(d,f,l,k){switch(aa(d,f)){case "transform":var m=-1<f.indexOf("scale")?1:0+(-1<f.indexOf("translate")||"perspective"===f?"px":-1<f.indexOf("rotate")||-1<f.indexOf("skew")?"deg":void 0);m=ca(d).get(f)||m;return k&&(k.transforms.list.set(f,m),k.transforms.last=f),l?H(d,m,l):m;case "css":return V(d,
f,l);case "attribute":return d.getAttribute(f);default:return d[f]||0}}function Fa(d,f){var l=/^(\*=|\+=|-=)/.exec(d);if(!l)return d;var k=W(d)||0;f=parseFloat(f);d=parseFloat(d.replace(l[0],""));switch(l[0][0]){case "+":return f+d+k;case "-":return f-d+k;case "*":return f*d+k}}function Ka(d,f){if(x.col(d))return na(d);if(/\s/g.test(d))return d;var l=W(d);d=l?d.substr(0,d.length-l.length):d;return f?d+f:d}function fa(d,f){return Math.sqrt(Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2))}function ha(d){d=
d.points;for(var f=0,l=0;l<d.numberOfItems;l++){var k=d.getItem(l);0<l&&(f+=fa(m,k));var m=k}return f}function ia(d){if(d.getTotalLength)return d.getTotalLength();switch(d.tagName.toLowerCase()){case "circle":return m=d,2*Math.PI*m.getAttribute("r");case "rect":return 2*(k=d).getAttribute("width")+2*k.getAttribute("height");case "line":return d=(l=d).getAttribute("x1"),fa({x:d,y:l.getAttribute("y1")},{x:l.getAttribute("x2"),y:l.getAttribute("y2")});case "polyline":return ha(d);case "polygon":return f=
(l=d).points,ha(l)+fa(f.getItem(f.numberOfItems-1),f.getItem(0))}var f,l,k,m}function ja(d,f){f=f||{};var l;if(!(l=f.el)){for(d=d.parentNode;x.svg(d)&&x.svg(d.parentNode);)d=d.parentNode;l=d}d=l;var k=d.getBoundingClientRect(),m=d.getAttribute("viewBox");l=k.width;k=k.height;f=f.viewBox||(m?m.split(" "):[0,0,l,k]);return{el:d,viewBox:f,x:f[0]/1,y:f[1]/1,w:l,h:k,vW:f[2],vH:f[3]}}function Ga(d,f,l){function k(I){void 0===I&&(I=0);return d.el.getPointAtLength(1<=f+I?f+I:0)}var m=ja(d.el,d.svg),t=k(),
y=k(-1),F=k(1),B=l?1:m.w/m.vW;l=l?1:m.h/m.vH;switch(d.property){case "x":return(t.x-m.x)*B;case "y":return(t.y-m.y)*l;case "angle":return 180*Math.atan2(F.y-y.y,F.x-y.x)/Math.PI}}function ya(d,f){var l=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,k=Ka(x.pth(d)?d.totalLength:d,f)+"";return{original:k,numbers:k.match(l)?k.match(l).map(Number):[0],strings:x.str(d)||f?k.split(l):[]}}function ra(d){return r(d?v(x.arr(d)?d.map(u):u(d)):[],function(f,l,k){return k.indexOf(f)===l})}function xa(d){var f=ra(d);
return f.map(function(l,k){return{target:l,id:k,total:f.length,transforms:{list:ca(l)}}})}function wa(d,f){var l=P(f);if(/^spring/.test(l.easing)&&(l.duration=c(l.easing)),x.arr(d)){var k=d.length;2!==k||x.obj(d[0])?x.fnc(f.duration)||(l.duration=f.duration/k):d={value:d}}var m=x.arr(d)?d:[d];return m.map(function(t,y){t=x.obj(t)&&!x.pth(t)?t:{value:t};return x.und(t.delay)&&(t.delay=y?0:f.delay),x.und(t.endDelay)&&(t.endDelay=y===m.length-1?f.endDelay:0),t}).map(function(t){return sa(t,l)})}function va(d,
f){var l=[],k=f.keyframes,m;for(m in k&&(f=sa(function(t){for(var y=r(v(t.map(function(E){return Object.keys(E)})),function(E){return x.key(E)}).reduce(function(E,G){return 0>E.indexOf(G)&&E.push(G),E},[]),F={},B=function(E){var G=y[E];F[G]=t.map(function(K){var N={},J;for(J in K)x.key(J)?J==G&&(N.value=K[J]):N[J]=K[J];return N})},I=0;I<y.length;I++)B(I);return F}(k),f)),f)x.key(m)&&l.push({name:m,tweens:wa(f[m],d)});return l}function p(d,f){var l;return d.tweens.map(function(k){k=function(E,G){var K=
{},N;for(N in E){var J=Q(E[N],G);x.arr(J)&&1===(J=J.map(function(S){return Q(S,G)})).length&&(J=J[0]);K[N]=J}return K.duration=parseFloat(K.duration),K.delay=parseFloat(K.delay),K}(k,f);var m=k.value,t=x.arr(m)?m[1]:m,y=W(t),F=qa(f.target,d.name,y,f),B=l?l.to.original:F,I=x.arr(m)?m[0]:B;F=W(I)||W(F);y=y||F;return x.und(t)&&(t=B),k.from=ya(I,y),k.to=ya(Fa(t,I),y),k.start=l?l.end:0,k.end=k.start+k.delay+k.duration+k.endDelay,k.easing=g(k.easing,k.duration),k.isPath=x.pth(m),k.isPathTargetInsideSVG=
k.isPath&&x.svg(f.target),k.isColor=x.col(k.from.original),k.isColor&&(k.round=1),l=k,k})}function Ba(d,f){xa(d).forEach(function(l){for(var k in f){var m=Q(f[k],l),t=l.target,y=W(m),F=qa(t,k,y,l);m=Fa(Ka(m,y||W(F)),F);y=aa(t,k);Na[y](t,k,m,l.transforms,!0)}})}function Ha(d,f){return r(v(d.map(function(l){return f.map(function(k){var m=aa(l.target,k.name);if(m){var t=p(k,l),y=t[t.length-1];k={type:m,property:k.name,animatable:l,tweens:t,duration:y.end,delay:t[0].delay,endDelay:y.endDelay}}else k=
void 0;return k})})),function(l){return!x.und(l)})}function Ia(d,f){var l=d.length,k={};return k.duration=l?Math.max.apply(Math,d.map(function(m){return(m.timelineOffset?m.timelineOffset:0)+m.duration})):f.duration,k.delay=l?Math.min.apply(Math,d.map(function(m){return(m.timelineOffset?m.timelineOffset:0)+m.delay})):f.delay,k.endDelay=l?k.duration-Math.max.apply(Math,d.map(function(m){return(m.timelineOffset?m.timelineOffset:0)+m.duration-m.endDelay})):f.endDelay,k}function n(d){function f(L){var R=
window.Promise&&new Promise(function(za){return N=za});return L.finished=R,R}function l(){var L=q.direction;"alternate"!==L&&(q.direction="normal"!==L?"normal":"reverse");q.reversed=!q.reversed;B.forEach(function(R){return R.reversed=q.reversed})}function k(L){return q.reversed?q.duration-L:L}function m(){I=0;E=k(q.currentTime)*(1/n.speed)}function t(L){for(var R=0,za=q.animations,La=za.length;R<La;){var X=za[R],oa=X.animatable,T=X.tweens,Ca=T.length-1,U=T[Ca];Ca&&(U=r(T,function(Sa){return L<Sa.end})[0]||
U);T=a(L-U.start-U.delay,0,U.duration)/U.duration;var ta=isNaN(T)?1:U.easing(T);T=U.to.strings;var Da=U.round;Ca=[];var Ja=U.to.numbers.length,da=void 0;for(da=0;da<Ja;da++){var Aa=void 0;Aa=U.to.numbers[da];var Oa=U.from.numbers[da]||0;Aa=U.isPath?Ga(U.value,ta*Aa,U.isPathTargetInsideSVG):Oa+ta*(Aa-Oa);Da&&(U.isColor&&2<da||(Aa=Math.round(Aa*Da)/Da));Ca.push(Aa)}if(U=T.length)for(da=T[0],ta=0;ta<U;ta++)T[ta],Da=T[ta+1],Ja=Ca[ta],isNaN(Ja)||(da+=Da?Ja+Da:Ja+" ");else da=Ca[0];Na[X.type](oa.target,
X.property,da,oa.transforms);X.currentValue=da;R++}}function y(L){q[L]&&!q.passThrough&&q[L](q)}function F(L){var R=q.duration,za=q.delay,La=R-q.endDelay,X=k(L);q.progress=a(X/R*100,0,100);q.reversePlayback=X<q.currentTime;if(B)if(q.reversePlayback)for(var oa=K;oa--;){var T=B[oa];T&&T.seek(X-T.timelineOffset)}else for(oa=0;oa<K;oa++)(T=B[oa])&&T.seek(X-T.timelineOffset);!q.began&&0<q.currentTime&&(q.began=!0,y("begin"));!q.loopBegan&&0<q.currentTime&&(q.loopBegan=!0,y("loopBegin"));X<=za&&0!==q.currentTime&&
t(0);(X>=La&&q.currentTime!==R||!R)&&t(R);X>za&&X<La?(q.changeBegan||(q.changeBegan=!0,q.changeCompleted=!1,y("changeBegin")),y("change"),t(X)):q.changeBegan&&(q.changeCompleted=!0,q.changeBegan=!1,y("changeComplete"));q.currentTime=a(X,0,R);q.began&&y("update");L>=R&&(E=0,q.remaining&&!0!==q.remaining&&q.remaining--,q.remaining?(I=G,y("loopComplete"),q.loopBegan=!1,"alternate"===q.direction&&l()):(q.paused=!0,q.completed||(q.completed=!0,y("loopComplete"),y("complete"),!q.passThrough&&"Promise"in
window&&(N(),f(q)))))}void 0===d&&(d={});var B,I=0,E=0,G=0,K=0,N=null,J,S,Z,Y,la,pa,ua,Ea,q=(S=ka(D,J=d),Z=ka(z,J),Y=va(Z,J),la=xa(J.targets),pa=Ha(la,Y),ua=Ia(pa,Z),Ea=Pa,Pa++,sa(S,{id:Ea,children:[],animatables:la,animations:pa,duration:ua.duration,delay:ua.delay,endDelay:ua.endDelay}));f(q);return q.reset=function(){var L=q.direction;q.passThrough=!1;q.currentTime=0;q.progress=0;q.paused=!0;q.began=!1;q.loopBegan=!1;q.changeBegan=!1;q.completed=!1;q.changeCompleted=!1;q.reversePlayback=!1;q.reversed=
"reverse"===L;q.remaining=q.loop;B=q.children;for(var R=K=B.length;R--;)q.children[R].reset();(q.reversed&&!0!==q.loop||"alternate"===L&&1===q.loop)&&q.remaining++;t(q.reversed?q.duration:0)},q._onDocumentVisibility=m,q.set=function(L,R){return Ba(L,R),q},q.tick=function(L){G=L;I||=G;F((G+(E-I))*n.speed)},q.seek=function(L){F(k(L))},q.pause=function(){q.paused=!0;m()},q.play=function(){q.paused&&(q.completed&&q.reset(),q.paused=!1,ea.push(q),m(),Qa())},q.reverse=function(){l();q.completed=!q.reversed;
m()},q.restart=function(){q.reset();q.play()},q.remove=function(L){w(ra(L),q)},q.reset(),q.autoplay&&q.play(),q}function A(d,f){for(var l=f.length;l--;)M(d,f[l].animatable.target)&&f.splice(l,1)}function w(d,f){var l=f.animations,k=f.children;A(d,l);for(var m=k.length;m--;){var t=k[m],y=t.animations;A(d,y);y.length||t.children.length||k.splice(m,1)}l.length||k.length||f.pause()}var D={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,
loop:1,direction:"normal",autoplay:!0,timelineOffset:0},z={duration:1E3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},C="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skew skewX skewY perspective matrix matrix3d".split(" "),ma={CSS:{},springs:{}},x={arr:function(d){return Array.isArray(d)},obj:function(d){return-1<Object.prototype.toString.call(d).indexOf("Object")},pth:function(d){return x.obj(d)&&d.hasOwnProperty("totalLength")},svg:function(d){return d instanceof
SVGElement},inp:function(d){return d instanceof HTMLInputElement},dom:function(d){return d.nodeType||x.svg(d)},str:function(d){return"string"==typeof d},fnc:function(d){return"function"==typeof d},und:function(d){return void 0===d},nil:function(d){return x.und(d)||null===d},hex:function(d){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(d)},rgb:function(d){return/^rgb/.test(d)},hsl:function(d){return/^hsl/.test(d)},col:function(d){return x.hex(d)||x.rgb(d)||x.hsl(d)},key:function(d){return!D.hasOwnProperty(d)&&
!z.hasOwnProperty(d)&&"targets"!==d&&"keyframes"!==d}},O,ba,Ra=function(){function d(f,l,k){return(((1-3*k+3*l)*f+(3*k-6*l))*f+3*l)*f}return function(f,l,k,m){function t(B){for(var I=0,E=1;10!==E&&y[E]<=B;++E)I+=.1;E=I+(B-y[--E])/(y[E+1]-y[E])*.1;var G=3*(1-3*k+3*f)*E*E+2*(3*k-6*f)*E+3*f;return.001<=G?function(K,N,J,S){for(var Z=0;4>Z;++Z){var Y=3*(1-3*S+3*J)*N*N+2*(3*S-6*J)*N+3*J;if(0===Y)break;N-=(d(N,J,S)-K)/Y}return N}(B,E,f,k):0===G?E:function(K,N,J,S,Z){for(var Y,la,pa=0;0<(Y=d(la=N+(J-N)/2,
S,Z)-K)?J=la:N=la,1E-7<Math.abs(Y)&&10>++pa;);return la}(B,I,I+.1,f,k)}if(0<=f&&1>=f&&0<=k&&1>=k){var y=new Float32Array(11);if(f!==l||k!==m)for(var F=0;11>F;++F)y[F]=d(.1*F,f,k);return function(B){return f===l&&k===m?B:0===B||1===B?B:d(t(B),l,m)}}}}(),Ma=(O={linear:function(){return function(d){return d}}},ba={Sine:function(){return function(d){return 1-Math.cos(d*Math.PI/2)}},Circ:function(){return function(d){return 1-Math.sqrt(1-d*d)}},Back:function(){return function(d){return d*d*(3*d-2)}},Bounce:function(){return function(d){for(var f,
l=4;d<((f=Math.pow(2,--l))-1)/11;);return 1/Math.pow(4,3-l)-7.5625*Math.pow((3*f-2)/22-d,2)}},Elastic:function(d,f){void 0===d&&(d=1);void 0===f&&(f=.5);var l=a(d,1,10),k=a(f,.1,2);return function(m){return 0===m||1===m?m:-l*Math.pow(2,10*(m-1))*Math.sin(2*(m-1-k/(2*Math.PI)*Math.asin(1/l))*Math.PI/k)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(d,f){ba[d]=function(){return function(l){return Math.pow(l,f+2)}}}),Object.keys(ba).forEach(function(d){var f=ba[d];O["easeIn"+d]=f;O["easeOut"+
d]=function(l,k){return function(m){return 1-f(l,k)(1-m)}};O["easeInOut"+d]=function(l,k){return function(m){return.5>m?f(l,k)(2*m)/2:1-f(l,k)(-2*m+2)/2}};O["easeOutIn"+d]=function(l,k){return function(m){return.5>m?(1-f(l,k)(1-2*m))/2:(f(l,k)(2*m-1)+1)/2}}}),O),Na={css:function(d,f,l){return d.style[f]=l},attribute:function(d,f,l){return d.setAttribute(f,l)},object:function(d,f,l){return d[f]=l},transform:function(d,f,l,k,m){if(k.list.set(f,l),f===k.last||m){var t="";k.list.forEach(function(y,F){t+=
F+"("+y+") "});d.style.transform=t}}},Pa=0,ea=[],Qa=function(){function d(l){for(var k=ea.length,m=0;m<k;){var t=ea[m];t.paused?(ea.splice(m,1),k--):(t.tick(l),m++)}f=0<m?requestAnimationFrame(d):void 0}var f;return"undefined"!=typeof document&&document.addEventListener("visibilitychange",function(){n.suspendWhenDocumentHidden&&(document&&document.hidden?f=cancelAnimationFrame(f):(ea.forEach(function(l){return l._onDocumentVisibility()}),Qa()))}),function(){f||document&&document.hidden&&n.suspendWhenDocumentHidden||
!(0<ea.length)||(f=requestAnimationFrame(d))}}();return n.version="3.2.1",n.speed=1,n.suspendWhenDocumentHidden=!0,n.running=ea,n.remove=function(d){d=ra(d);for(var f=ea.length;f--;)w(d,ea[f])},n.get=qa,n.set=Ba,n.convertPx=H,n.path=function(d,f){var l=x.str(d)?h(d)[0]:d,k=f||100;return function(m){return{property:m,el:l,svg:ja(l),totalLength:ia(l)*(k/100)}}},n.setDashoffset=function(d){var f=ia(d);return d.setAttribute("stroke-dasharray",f),f},n.stagger=function(d,f){void 0===f&&(f={});var l=f.direction||
"normal",k=f.easing?g(f.easing):null,m=f.grid,t=f.axis,y=f.from||0,F="first"===y,B="center"===y,I="last"===y,E=x.arr(d),G=E?parseFloat(d[0]):parseFloat(d),K=E?parseFloat(d[1]):0,N=W(E?d[1]:d)||0,J=f.start||0+(E?G:0),S=[],Z=0;return function(Y,la,pa){if(F&&(y=0),B&&(y=(pa-1)/2),I&&(y=pa-1),!S.length){for(Y=0;Y<pa;Y++){if(m){var ua=(B?(m[0]-1)/2:y%m[0])-Y%m[0],Ea=(B?(m[1]-1)/2:Math.floor(y/m[0]))-Math.floor(Y/m[0]),q=Math.sqrt(ua*ua+Ea*Ea);"x"===t&&(q=-ua);"y"===t&&(q=-Ea);S.push(q)}else S.push(Math.abs(y-
Y));Z=Math.max.apply(Math,S)}k&&(S=S.map(function(L){return k(L/Z)*Z}));"reverse"===l&&(S=S.map(function(L){return t?0>L?-1*L:-L:Math.abs(Z-L)}))}return J+Math.round(100*S[la])/100*(E?(K-G)/Z:G)+N}},n.timeline=function(d){void 0===d&&(d={});var f=n(d);return f.duration=0,f.add=function(l,k){var m=ea.indexOf(f),t=f.children;-1<m&&ea.splice(m,1);for(m=0;m<t.length;m++)t[m].passThrough=!0;l=sa(l,ka(z,d));l.targets=l.targets||d.targets;m=f.duration;l.autoplay=!1;l.direction=f.direction;l.timelineOffset=
x.und(k)?m:Fa(k,m);f.passThrough=!0;f.seek(l.timelineOffset);k=n(l);k.passThrough=!0;t.push(k);t=Ia(t,d);return f.delay=t.delay,f.endDelay=t.endDelay,f.duration=t.duration,f.seek(0),f.reset(),f.autoplay&&f.play(),f},f},n.easing=g,n.penner=Ma,n.random=function(d,f){return Math.floor(Math.random()*(f-d+1))+d},n});var cc=cc||{};
cc.defineGetterSetter=function(a,b,c,e,g,h){if(a.__defineGetter__)c&&a.__defineGetter__(b,c),e&&a.__defineSetter__(b,e);else if(Object.defineProperty){var r={enumerable:!1,configurable:!0};c&&(r.get=c);e&&(r.set=e);Object.defineProperty(a,b,r)}else throw Error("browser does not support getters");if(!g&&!h){r=null!=c;for(var v=void 0!=e,u=Object.getOwnPropertyNames(a),M=0;M<u.length;M++){var P=u[M];if((a.__lookupGetter__?!a.__lookupGetter__(P):!Object.getOwnPropertyDescriptor(a,P))&&"function"===typeof a[P]){var ka=
a[P];if(r&&ka===c&&(g=P,!v||h))break;if(v&&ka===e&&(h=P,!r||g))break}}}a=a.constructor;g&&(a.__getters__||(a.__getters__={}),a.__getters__[g]=b);h&&(a.__setters__||(a.__setters__={}),a.__setters__[h]=b)};cc.clone=function(a){var b=a.constructor?new a.constructor:{},c;for(c in a){var e=a[c];b[c]="object"!==typeof e||!e||e instanceof cc.Node||e instanceof HTMLElement?e:cc.clone(e)}return b};cc.inject=function(a,b){for(var c in a)b[c]=a[c]};
var ClassManager=function(){var a=0|998*Math.random(),b=0|998*Math.random();this.getNewID=function(){return a++};this.getNewInstanceId=function(){return b++}},classManager=new ClassManager;
(function(){var a=/\b_super\b/;cc.Class=function(){};cc.Class.extend=function(b){cc.isEmpty(b._html)||cc.import(b._html);cc.isEmpty(b._css)||cc.import(b._css);var c=this.prototype,e=Object.create(c),g={writable:!0,enumerable:!1,configurable:!0};var h=function(H,V,aa,ca,qa){this.__instanceId=classManager.getNewInstanceId();if(this.ctor)switch(arguments.length){case 0:this.ctor();break;case 1:this.ctor(H);break;case 2:this.ctor(H,V);break;case 3:this.ctor(H,V,aa);break;case 4:this.ctor(H,V,aa,ca);break;
case 5:this.ctor(H,V,aa,ca,qa);break;default:this.ctor.apply(this,arguments)}};g.value=classManager.getNewID();Object.defineProperty(e,"__pid",g);h.prototype=e;g.value=h;Object.defineProperty(e,"constructor",g);this.__getters__&&(h.__getters__=cc.clone(this.__getters__));this.__setters__&&(h.__setters__=cc.clone(this.__setters__));for(var r=0,v=arguments.length;r<v;++r){var u=arguments[r],M;for(M in u){var P="function"===typeof u[M],ka="function"===typeof c[M],sa=a.test(u[M]);P&&ka&&sa?(g.value=function(H,
V){return function(){var aa=this._super;this._super=c[H];var ca=V.apply(this,arguments);this._super=aa;return ca}}(M,u[M]),Object.defineProperty(e,M,g)):P?(g.value=u[M],Object.defineProperty(e,M,g)):e[M]=u[M];if(P){if(this.__getters__&&this.__getters__[M]){P=this.__getters__[M];for(var na in this.__setters__)if(this.__setters__[na]===P){var W=na;break}cc.defineGetterSetter(e,P,u[M],u[W]?u[W]:e[W],M,W)}if(this.__setters__&&this.__setters__[M]){P=this.__setters__[M];for(na in this.__getters__)if(this.__getters__[na]===
P){var Q=na;break}cc.defineGetterSetter(e,P,u[Q]?u[Q]:e[Q],u[M],Q,M)}}}}h.extend=cc.Class.extend;h.implement=function(H){for(var V in H)e[V]=H[V]};return h}})();cc.each=function(a,b,c){if(a)if(a instanceof Array)for(var e=0,g=a.length;e<g&&!1!==b.call(c,a[e],e);e++);else for(e in a)if(!1===b.call(c,a[e],e))break};cc.extend=function(a){var b=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];cc.each(b,function(c){for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e])});return a};
cc.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};cc.isFunction=function(a){return"function"===typeof a};cc.isNumber=function(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)};cc.isString=function(a){return"string"===typeof a||"[object String]"===Object.prototype.toString.call(a)};cc.isArray=function(a){return Array.isArray(a)||"object"===typeof a&&"[object Array]"===Object.prototype.toString.call(a)};
cc.isUndefined=function(a){return"undefined"===typeof a};cc.isObject=function(a){return"object"===typeof a&&"[object Object]"===Object.prototype.toString.call(a)};cc.objToArray=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};cc.localLog={maxLog:20,isLocalStorage:localStorage?!0:!1,push:function(a){},send:function(a,b){}};cc.log=function(a){var b=(new Date).toISOString();a=b.substr(b.length-13,13)+"--"+a;console.log(a)};
cc.isEmpty=function(a){return void 0==a||null==a||""==a.toString()?!0:!1};String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)};cc.Class.prototype.addCEventListener=function(a,b,c){null==this.arrEventCb&&(this.arrEventCb=[]);for(var e=!1,g=0;g<this.arrEventCb.length;g++)if(this.arrEventCb[g].ev==a&&this.arrEventCb[g].cb==b&&this.arrEventCb[g].caller==c){e=!0;break}e||this.arrEventCb.push({ev:a,cb:b,caller:c})};
cc.Class.prototype.removeCEventListener=function(a,b,c){null==this.arrEventCb&&(this.arrEventCb=[]);for(var e=0;e<this.arrEventCb.length;e++)if(this.arrEventCb[e].ev==a&&this.arrEventCb[e].cb==b&&c==this.arrEventCb[e].caller){this.arrEventCb.splice(e,1);break}};cc.Class.prototype.CEventCallback=function(a){if(null!=this.arrEventCb)for(var b=this.arrEventCb.concat(),c=0;c<b.length;c++)b[c].ev==a&&b[c].cb.apply(b[c].caller,arguments)};
cc.Class.prototype.dispath=function(a){if(null!=this.arrEventCb)for(var b=this.arrEventCb.concat(),c=0;c<b.length;c++)b[c].ev==a&&b[c].cb.apply(b[c].caller,arguments)};cc.Class.prototype.removeAllCEventListener=function(a){if(null==a)null!=this.arrEventCb&&(this.arrEventCb=[]);else if(null!=this.arrEventCb&&void 0!=this.arrEventCb){do{var b=!1;for(var c=0;c<this.arrEventCb.length;c++)if(this.arrEventCb[c].ev==a){this.arrEventCb.splice(c,1);b=!0;break}}while(b)}};
cc.os=function(){var a=navigator.userAgent.toLowerCase(),b=/iphone|ipod|ipad/.test(a);return/android/.test(a)?"android":b?"ios":"pc"};cc.isMobile=function(){return"android"==cc.os||"ios"==cc.os?!0:!1};cc.isWebview=function(){return"zaloWebview"==cc.browserName||"fbWebview"==cc.browserName||"webview"==cc.browserName?!0:!1};
cc.browserName=function(){var a=navigator.userAgent.toLowerCase();if(0<=a.indexOf("zalo"))return"zaloWebview";if(0<=a.indexOf("FBAV"))return"fbWebview";if(0<=a.indexOf("webview"))return"webview";if(0<=a.indexOf("coccoc"))return"coccoc";var b=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),c="undefined"!==typeof InstallTrigger,e=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!==typeof safari&&window.safari.pushNotification).toString();
0<=a.indexOf("safari")&&(e=!0);a=!!document.documentMode;var g=!a&&!!window.StyleMedia,h=-1!=navigator.userAgent.indexOf("Chrome"),r=h&&-1!=navigator.userAgent.indexOf("Edg");return b?"opera":e?"safari":c?"firefox":g?"edge":a?"ie":h?"chrome":r?"edgeChrome":"other"};cc.touchable=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};
cc.webrtcSupport=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.enumerateDevices&&"undefined"!=typeof RTCPeerConnection?!0:!1};cc.mediaRecorderSupport=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&window.MediaRecorder?!0:!1};cc.workerSupport=function(){return"undefined"!==typeof Worker?!0:!1};
cc.fullscreenSupport=function(){var a=document.body;return"undefined"!==typeof a.requestFullscreen||"undefined"!==typeof a.mozRequestFullScreen||"undefined"!==typeof a.webkitRequestFullscreen||"undefined"!==typeof a.msRequestFullscreen||"undefined"!==typeof document.exitFullscreen||"undefined"!==typeof document.mozCancelFullScreen||"undefined"!==typeof document.webkitExitFullscreen};cc.removeAllChildNodes=function(a){if(a)for(;a.firstChild;)a.removeChild(a.firstChild)};
cc.removeDomAttr=function(a,b){if(cc.isArray(b)&&a&&a instanceof HTMLElement)for(var c=0;c<b.length;c++)a.removeAttribute(b[c])};cc.getAttrToNumber=function(a,b){return Number(a.getAttribute(b))};cc.createGrid=function(a,b){if(0>=a||0>=b)return null;for(var c=document.createElement("div"),e=100/a,g=100/b,h=0;h<a*b;h++){var r=document.createElement("div");r.style.width=g+"%";r.style.height=e+"%";r.style.position="relative";r.style.float="left";r.setAttribute("grid",h);c.appendChild(r)}return c};
cc.dragDom=null;cc.winSize=function(){return{width:window.innerWidth,height:window.innerHeight}};cc.getParameterByName=function(a,b=window.location.href){a=a.replace(/[\[\]]/g,"\\$&");return(a=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(b))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};cc.appVer=.1;
cc.loadCss=function(a){for(var b=0;b<a.length;b++){var c=document.getElementsByTagName("HEAD")[0],e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href=a[b]+"?ver="+cc.appVer;c.appendChild(e)}};cc.insertCss=function(a){var b=document.createElement("style");b.type="text/css";b.innerHTML=a;document.getElementsByTagName("head")[0].appendChild(b)};
cc.getText=function(a,b){if(a)try{const c=new XMLHttpRequest;c.onreadystatechange=function(){4==this.readyState&&(200==this.status?b&&b(!0,this.responseText):b(!1,this.status))};c.open("GET",a+"?ver="+cc.appVer);c.send()}catch(c){b(!1,c.toString())}};
cc.getJson=function(a,b){if(a)try{const c=new XMLHttpRequest;c.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){if(b)try{b(!0,JSON.parse(this.responseText))}catch(e){b(!1,"error parse json result "+this.responseText)}}else b(!1,this.status)};c.open("GET",a+"?ver="+cc.appVer);c.send()}catch(c){b(!1,c.toString())}};
cc.loadJs=function(a,b,c){cc.isString(a)&&(a=[a]);if(!cc.isNumber(c)||0>c)c=0;if(a&&cc.isArray(a))if(a.length<=c)b&&b.call(null,!0);else{var e=a[c],g=document.createElement("script");g.onload=()=>{c<a.length&&(c++,cc.loadJs(a,b,c))};g.onerror=()=>{b&&b.call(null,!1)};g.src=e+"?ver="+cc.appVer;g.async=!0;document.body.appendChild(g)}};
cc.loadHtml=function(a,b,c){if(!cc.isNumber(c)||0>c)c=0;a&&cc.isArray(a)&&(a.length<=c?b&&b.call(null,!0):cc.getText(a[c],(e,g)=>{e&&(cc.htmlImport[a[c]]=g);c++;cc.loadHtml(a,b,c)}))};cc.jsfw=[];cc.coreready=null;cc.callbackready=null;cc.onready=function(a){null==cc.coreready?cc.callbackready=a:a.call(null,cc.coreready)};cc.loadJs(cc.jsfw,a=>{cc.coreready=a;cc.callbackready&&cc.callbackready.call(null,cc.coreready)});cc.htmlImport={};cc.cssImport={};
cc.getHtml=function(a){return cc.htmlImport[a]?cc.htmlImport[a]:""};cc.import=function(a){0<a.indexOf(".css")&&(cc.cssImport[a]||(cc.cssImport[a]=a));0<a.indexOf(".html")&&(cc.htmlImport[a]||(cc.htmlImport[a]=a))};cc.initApp=function(a,b){cc.loadJs(a,c=>{cc.loadCss(cc.objToArray(cc.cssImport));cc.loadHtml(cc.objToArray(cc.htmlImport),()=>{b&&b()})})};cc.keywordNotStyle=["element","_childStyle","state"];
cc.Node=cc.Class.extend({_name:"",_lcid:0,_countChild:0,_render:null,_children:null,_parent:null,_style:null,_nodeType:"Node",ctor:function(a){this._initRender(a);a&&this.css(a)},_initRender:function(a){a||={};cc.isEmpty(a.element)&&(a.element=cc.getHtml(this._html));if(!cc.isEmpty(a.element)){if(cc.isString(a.element))try{var b=document.createElement("div");b.innerHTML=a.element.trim();var c=b.firstChild;if(c&&1==c.nodeType){this._render=c;this._render.setAttribute("_nt",this.getType());return}}catch(e){cc.log("error create element from  html :"+
a.element+":"+this._idLocal+":"+this.getType())}if(a.element instanceof HTMLElement){this._render=a.element;this._render.setAttribute("_nt",this.getType());return}}this._render=document.createElement("div");this._render.setAttribute("_nt",this.getType())},appendTo:function(a){a instanceof HTMLElement&&a.appendChild(this._render)},addChild:function(a){a._nodeType&&this._render&&a._render instanceof HTMLElement&&(this._render.appendChild(a._render),this._children=this._children||{},a._lcid=this._countChild++,
this._children[a._lcid]=a,a._parent=this)},removeChild:function(a,b){a._parent&&a._parent._render&&a._parent._render.removeChild(a._render);delete this._children[a._idNode];b&&a.release&&a.release()},removeAllChild:function(){for(var a in this._children)this.removeChild(this._children[a])},children:function(){var a=[],b;for(b in this._children)a.push(this._children);return a},getParent:function(){return this._parent},getRender:function(){return this._render},getChildrenByName:function(a){if(cc.isEmpty(a))return null;
for(var b in this._children)if(this._children[b].name==a)return this._children[b]},getChildByLcId:function(a){return!cc.isNumber(a)||0>Number(a)?null:this._children[a]?this._children[a]:null},toObject:function(){},fromObject:function(a){this._countChild=a.countChild?a.countChild:this._countChild},getType:function(){return this._nodeType},_release:function(){this.removeAllChild();this._render=null;this.removeAllCEventListener()},cssChild:function(a){if(this._render)for(var b in a){var c=this._render.getChildrenByName(b);
if(c)for(var e=0;e<c.length;e++)this.cssDom(c[e],a[b])}},css:function(a,b){if(!this._render||!this._render.style)return!1;this._style=this._style||{};var c=!0;if(cc.isString(a)){if(!b)return this._render.style[a];0>cc.keywordNotStyle.indexOf(a)&&(a=this._replaceCssProperties(a),this._render.style[a]=b,this._render.style[a]==b?this._style[a]=b:c=!1)}else{a=this._replaceCssProperties(a);for(var e in a)0>cc.keywordNotStyle.indexOf(e)?(this._render.style[e]=a[e],this._render.style[e]==a[e]?this._style[e]=
a[e]:c=!1):"_childStyle"==e&&this.cssChild(a[e])}""!=this._render.style.display&&"none"!=this._render.style.display&&(this._render.style.cdisplay=this._render.style.display);if(this._style.scaleX||this._style.scaleY||this._style.rotation)a="",this._style.rotation&&(a+="rotate("+this._style.rotation+"deg) "),this._style.scaleX&&(a+="scaleX("+this._style.scaleX+") "),this._style.scaleY&&(a+="scaleY("+this._style.scaleY+") "),this._render.style.transform=a;return c},cssDom:function(a,b,c){if(cc.isString(b))b=
this._replaceCssProperties(b),a.style[b]=c;else{b=this._replaceCssProperties(b);for(var e in b)a.style[e]=b[e]}},_replaceCssProperties:function(a){cc.isObject(a)&&(void 0!=a.x&&(a.left=a.x),void 0!=a.y&&(a.top=a.y),void 0!=a.rotate&&(a.rotation=a.rotate),delete a.x,delete a.y);if(cc.isString(a)){if("x"==a)return"left";if("y"==a)return"top";if("rotate"==a)return"ratation"}return a},_renderStyle:function(){return this._render&&this._render.style?this._render.style:null},setWidth:function(a){return this._renderStyle()?
cc.isString(a)?this.css("width",a):!cc.isNumber(a)||0>Number(a)?!1:this.css("width",a+"px"):!1},getWidth:function(){return this._renderStyle()?parseInt(this._render.style.width):0},setHeight:function(a){return this._renderStyle()?cc.isString(a)?this.css("height",a):!cc.isNumber(a)||0>Number(a)?!1:this.css("height",a+"px"):!1},getHeight:function(){return this._renderStyle()?parseInt(this._render.style.height):0},setX:function(a){return this._renderStyle()&&cc.isNumber(a)?this.css("left",a+"px"):!1},
getX:function(){return this._renderStyle()?parseInt(this._render.style.left):0},setY:function(a){return this._renderStyle()&&cc.isNumber(a)?this.css("top",a+"px"):!1},getY:function(){return this._renderStyle()?parseInt(this._render.style.top):0},getClientBoudingBox:function(){return this._render&&this._render.getClientBoudingBox?this._render.getClientBoudingBox():null},setVisible:function(a){this._renderStyle()&&(this._render.style.display=a?cc.isUndefined(this._render.style.cdisplay)?"":this._render.style.cdisplay:
"none")},getVisible:function(){return this._renderStyle()?"none"==this._render.style.display?!0:!1:!1},setColor:function(a){return this._renderStyle()?this.css("color",a):!1},getColor:function(){return this._renderStyle()?this._render.style.color.toString():""},setOpacity:function(a){return this._renderStyle()?this.css("opacity",a):!1},getOpacity:function(){return this._renderStyle()&&cc.isNumber(this._render.style.opacity)?this._render.style.opacity:1},setRotate:function(a){return!this._renderStyle()||
!cc.isNumber(a)||0>Number(a)?!1:this.css("rotation",a)},getRotate:function(){return this._renderStyle()&&this._style.rotation?this._style.rotation:0},setScaleX:function(a){return this._renderStyle()&&cc.isNumber(a)?this.css("scaleX",a):!1},getScaleX:function(){return this._renderStyle()&&this._style.scaleX?this._style.scaleX:1},setScaleY:function(a){return this._renderStyle()&&cc.isNumber(a)?this.css("scaleY",a):!1},getScaleY:function(){return this._renderStyle()&&this._style.scaleY?this._style.scaleY:
1},setScale:function(a,b){this.setScaleX(a);this.setScaleY(b)},setButtonMode:function(a){if(!this._renderStyle())return!1;a?this.css("cursor","pointer"):this.css("cursor","default")},anim:function(a,b,c,e){cc.isObject(a)||cc.isArray(a)?this.animFromTo(null,a,b,c,e):cc.isString(a)&&this._render&&(a=cc.animePattern.getFromTo(a,this))&&(b&&(a.to.duration=b),this.animFromTo(a.from,a.to,b,c,e))},animFromTo:function(a,b,c,e,g){if(this._render&&b&&(cc.isArray(b)||cc.isObject(b))){e&&"true"==e.toString().trim()||
(e=!1);g||="normal";try{this.stopAnim();this.timeline=anime.timeline({targets:this._render,loop:e,duration:Number(c),direction:g});a&&cc.isObject(a)&&(a=this._replaceCssProperties(a),this.timeline._from=a,this.css(a));if(cc.isArray(b))for(a=0;a<b.length;a++)b[a]=this._replaceCssProperties(b[a]),this.timeline.add(b[a]);else cc.isObject(b)&&(b=this._replaceCssProperties(b),this.timeline.add(b));this.timeline._animto=b}catch(h){cc.log("runAnim error "+h.message)}}},stopAnimToEnd:function(){this.timeline&&
this.timeline.pause();anime.remove(this._render);for(var a=0;a<this.timeline._animto.length;a++){var b=this.timeline._animto[a];delete b.targets;delete b.easing;delete b.duration;delete b.delay;delete b.endDelay;delete b.round;this.css(b)}delete this.timeline._from;delete this.timeline._timelines},stopAnim:function(){this.timeline&&(this.timeline.pause(),anime.remove(this._render),delete this.timeline._from,delete this.timeline._timelines)},addTouchStart:function(a){this.addDomTouchStart(this._render,
a)},removeTouchStart:function(){this.removeDomTouchStart(this._render)},addDomTouchStart:function(a,b){a.touchStartEnabled=!0;a.addEventListener("mousedown",c=>{this._onDomDown(c,b)});a.addEventListener("touchstart",c=>{this._onDomDown(c,b);c.preventDefault()})},_onDomDown:function(a,b){if(a.currentTarget.touchStartEnabled){var c=a.touches&&0<a.touches.length?a.touches[0]:a;a=a.currentTarget;c.target=a==this._render?this:a;c.time=(new Date).getTime();cc.removeDomAttr(a,"move_time move_pageX move_pageY move_clientX move_clientY end_time".split(" "));
a.setAttribute("start_time",c.time);a.setAttribute("start_pageX",c.pageX);a.setAttribute("start_pageY",c.pageY);a.setAttribute("start_clientX",c.clientX);a.setAttribute("start_clientY",c.clientY);_windowUp();a.dragEnabled&&(cc.dragDom=a,a.setAttribute("start_left",parseInt(a.style.left)),a.setAttribute("start_top",parseInt(a.style.top)),window.addEventListener("mousemove",_windowMove),window.addEventListener("touchmove",_windowMove),window.addEventListener("mouseup",_windowUp),window.addEventListener("touchend",
_windowUp));b&&b(c)}},removeDomTouchStart:function(a){a.dragEnabled||(a.touchStartEnabled=!1)},addTouchMove:function(a){this.addDomTouchMove(this._render,a)},removeTouchMove:function(){this.removeDomTouchMove(this._render)},addDomTouchMove:function(a,b){a.touchMoveEnabled=!0;a.addEventListener("mousemove",c=>{this._onDomMove(c,b)});a.addEventListener("touchmove",c=>{this._onDomMove(c,b);c.preventDefault()})},_onDomMove:function(a,b){if(a.currentTarget.touchMoveEnabled){var c=a.touches&&0<a.touches.length?
a.touches[0]:a;a=a.currentTarget;c.target=a==this._render?this:a;c.time=(new Date).getTime();a.setAttribute("move_time",c.time);a.setAttribute("move_pageX",c.pageX);a.setAttribute("move_pageY",c.pageY);a.setAttribute("move_clientX",c.clientX);a.setAttribute("move_clientY",c.clientY);b&&b(c)}},removeDomTouchMove:function(a){a.touchMoveEnabled=!1},addTouchOut:function(a){this.addDomTouchOut(this._render,a)},removeTouchOut:function(){this.removeDomTouchOut(this._render)},addDomTouchOut:function(a,b){a.touchOutEnabled=
!0;a.addEventListener("mouseout",c=>{this._onDomOut(c,b)})},_onDomOut:function(a,b){if(a.target.touchOutEnabled){var c=a.touches&&0<a.touches.length?a.touches[0]:a;a=a.currentTarget;c.target=a==this._render?this:a;c.time=(new Date).getTime();b&&b(c)}},removeDomTouchOut:function(a){a.touchOutEnabled=!1},addTouchEnd:function(a){this.addDomTouchEnd(this._render,a)},removeTouchEnd:function(){this.removeDomTouchEnd(this._render)},addDomTouchEnd:function(a,b){a.touchEndEnabled=!0;a.addEventListener("mouseup",
c=>{this._onDomEnd(c,b)});a.addEventListener("touchend",c=>{this._onDomEnd(c,b);c.preventDefault()})},_onDomEnd:function(a,b){if(a.currentTarget.touchEndEnabled){var c=a.touches&&0<a.touches.length?a.touches[0]:a;a=a.currentTarget;c.target=a==this._render?this:a;c.time=(new Date).getTime();a.setAttribute("end_time",c.time);b&&b(c);this._onDomTap(a);cc.removeDomAttr(a,"move_time move_pageX move_pageY move_clientX move_clientY end_time".split(" "));cc.removeDomAttr(a,["start_time","start_pageX","start_pageY",
"start_clientX","start_clientY"])}},removeDomTouchEnd:function(a){a.touchEndEnabled=!1},addTouch:function(a){this.addTouchTap(a)},removeTouch:function(){this.removeTouchTap()},addDomTouch:function(a,b){this.addDomTouchTap(a,b)},addTouchTap:function(a){this.addDomTouchTap(this._render,a)},removeTouchTap:function(){this.removeDomTouchTap(this._render)},addDomTouchTap:function(a,b){a.touchStartEnabled||this.addDomTouchStart(a);a.touchEndEnabled||this.addDomTouchEnd(a);a.touchTapEnabled=!0;a.callbacksTap=
a.callbacksTap||[];b&&a.callbacksTap.push(b)},_onDomTap:function(a){a.getAttribute("move_pageX")||a.setAttribute("move_pageX",a.getAttribute("start_pageX"));a.getAttribute("move_pageY")||a.setAttribute("move_pageY",a.getAttribute("start_pageY"));if(150>cc.getAttrToNumber(a,"end_time")-cc.getAttrToNumber(a,"start_time")&&10>Math.abs(cc.getAttrToNumber(a,"start_pageX")-cc.getAttrToNumber(a,"move_pageX"))&&10>Math.abs(cc.getAttrToNumber(a,"start_pageY")-cc.getAttrToNumber(a,"move_pageY"))){if(a.getAttribute("tap_time")&&
200>(new Date).getTime()-cc.getAttrToNumber(a,"tap_time")){if(a.callbacksDoubleTap)for(var b=0;b<a.callbacksDoubleTap.length;b++)a.callbacksDoubleTap[b].call(null,{target:a==this._render?this._render:a})}else if(a.callbacksTap)for(b=0;b<a.callbacksTap.length;b++)a.callbacksTap[b].call(null,{target:a==this._render?this._render:a});a.setAttribute("tap_time",(new Date).getTime())}},removeDomTouchTap:function(a){a.callbacksTap&&(a.touchTapEnabled=!1,a.callbacksTap=null,delete a.callbacksTap)},addTouchDouble:function(a){this.addDomTouchDoubleTap(this._render,
a)},addTouchDoubleTap:function(a){this.addDomTouchDoubleTap(this._render,a)},removeTouchDoubleTap:function(){this.removeDomTouchDoubleTap(this._render)},addDomTouchDoubleTap:function(a,b){a.touchTapEnabled||this.addDomTouchTap(a);a.touchDoubleTapEnable=!0;a.callbacksDoubleTap=a.callbacksDoubleTap||[];b&&a.callbacksDoubleTap.push(b)},removeDomTouchDoubleTap:function(a){a.callbacksDoubleTap&&(a.touchDoubleTapEnable=!1,a.callbacksDoubleTap=null,delete a.callbacksDoubleTap)},_dragEnabled:!1,setDragEnabled:function(a){this._render&&
(this.setDragEnabledDom(this._render,a),this._dragEnabled=a)},getDragEnabled:function(){return this._dragEnabled},setDragEnabledDom:function(a,b){b&&!a.touchStartEnabled&&this.addDomTouchStart(a);a.dragEnabled=!!b},findDom:function(a){var b=null;if(!a)return null;a instanceof HTMLElement?b=a:cc.isString(a)&&(b=this._render.querySelector(a));b._ccinit||(b._ccinit=!0,b.css=(c,e)=>{if(cc.isString(c))b.style[c]=e;else if(cc.isObject(c))for(var g in c)b.style[g]=c[g]},b.getBoxGrid=c=>this.findDom(b.querySelector("[grid='"+
c+"']")),b.addTouch=c=>{this.addDomTouchTap(b,c)},b.removeTouch=()=>{this.removeDomTouchTap(b)},b.addTouchStart=c=>{this.addDomTouchStart(b,c)},b.removeTouchStart=()=>{this.removeDomTouchStart(b)},b.addTouchMove=c=>{this.addDomTouchMove(b,c)},b.removeTouchMove=()=>{this.removeDomTouchMove(b)},b.addTouchOut=c=>{this.addDomTouchOut(b,c)},b.removeTouchOut=()=>{this.removeDomTouchOut(b)},b.addTouchEnd=c=>{this.addDomTouchEnd(b,c)},b.removeTouchEnd=()=>{this.removeDomTouchEnd(b)},b.addTouchDouble=c=>{this.addDomTouchDoubleTap(b,
c)},b.removeTouchDouble=()=>{this.removeDomTouchDoubleTap(b)});return b},findAllDom:function(a){}});cc.Node.fromObject=function(a){return cc.Node().fromObject(a)};var _p=cc.Node.prototype;cc.defineGetterSetter(_p,"parent",_p.getParent,_p.getParent);cc.defineGetterSetter(_p,"render",_p.getRender,_p.getRender);cc.defineGetterSetter(_p,"width",_p.getWidth,_p.setWidth);cc.defineGetterSetter(_p,"height",_p.getHeight,_p.setHeight);cc.defineGetterSetter(_p,"x",_p.getX,_p.setX);
cc.defineGetterSetter(_p,"left",_p.getX,_p.setX);cc.defineGetterSetter(_p,"y",_p.getY,_p.setY);cc.defineGetterSetter(_p,"top",_p.getY,_p.setY);cc.defineGetterSetter(_p,"visible",_p.getVisible,_p.setVisible);cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor);cc.defineGetterSetter(_p,"scale",_p.getScale,_p.getScale);cc.defineGetterSetter(_p,"scaleX",_p.getScaleX,_p.setScaleX);cc.defineGetterSetter(_p,"scaleY",_p.getScaleY,_p.setScaleY);
cc.defineGetterSetter(_p,"rotate",_p.getRotate,_p.setRotate);cc.defineGetterSetter(_p,"buttonMode",_p.setButtonMode,_p.setButtonMode);cc.defineGetterSetter(_p,"anchorX",_p.getAnchorX,_p.setAnchorX);cc.defineGetterSetter(_p,"anchorY",_p.getAnchorY,_p.setAnchorY);cc.defineGetterSetter(_p,"touchEnabled",_p.getTouchEnabled,_p.setTouchEnabled);cc.defineGetterSetter(_p,"dragEnabled",_p.getDragEnabled,_p.setDragEnabled);
function _windowMove(a){var b=a.touches&&0<a.touches.length?a.touches[0]:a;a=cc.dragDom;var c=b.pageX-cc.getAttrToNumber(a,"start_pageX");b=b.pageY-cc.getAttrToNumber(a,"start_pageY");a==this._render?(this.x=c+cc.getAttrToNumber(a,"start_left"),this.y=b+cc.getAttrToNumber(a,"start_top")):(a.style.left=c+cc.getAttrToNumber(a,"start_left")+"px",a.style.top=b+cc.getAttrToNumber(a,"start_top")+"px")}
function _windowUp(a){window.removeEventListener("mousemove",_windowMove);window.removeEventListener("touchmove",_windowMove);window.removeEventListener("mouseup",_windowUp);window.removeEventListener("touchend",_windowUp);cc.dragDom&&cc.dragDom.removeAttribute("start_left");cc.dragDom&&cc.dragDom.removeAttribute("start_top");cc.dragDom&&cc.removeDomAttr(cc.dragDom,["start_time","start_pageX","start_pageY","start_clientX","start_clientY"]);cc.dragDom=null};var aztExam=aztExam||{};
aztExam.RTCConnection=cc.Class.extend({conn:null,candidate:null,callback:null,isUsed:!1,remoteUserId:"",localUserId:"",type:"offer",monitor:null,offerTimestamp:-1,timeIntv:3E3,timeAnswerIntv:6500,timeIntvCount:0,blacklistTimestamp:null,lasttimestamp:-1,isWaitingUploadOffer:!1,isWaitingUploadAnswer:!1,offer:null,answer:null,offerReceive:null,isUsefirestore:!1,ctor:function(a){this.blacklistTimestamp=[];this.monitor=a;this.monitor.firebaseApp&&(this.isUsefirestore=!0);this.initUI()},initUI:function(){this.ui=
document.createElement("div");this.ui.style.transformOrigin="0% 0%";this.ui.style.overflow="hidden";this.uivideo=document.createElement("div");this.uivideo.style.width="100%";this.uivideo.style.height="100%";this.uivideo.style.display="flex";this.uivideo.style.flexDirection="row";this.uivideo.style.alignItems="center";this.uivideo.style.justifyContent="center";this.ui.appendChild(this.uivideo);this.txtConnecting=document.createElement("div");this.txtConnecting.style.backgroundColor="#333333";this.txtConnecting.style.width=
"250px";this.txtConnecting.style.padding="20px";this.txtConnecting.style.borderRadius="8px";this.txtConnecting.style.color="#EEEEEE";this.txtConnecting.style.fontSize="16px";this.txtConnecting.innerHTML=aztExam.lang.lbConnectingMedia;this.txtConnecting.style.position="absolute";this.txtConnecting.style.bottom="20px";this.txtConnecting.style.textAlign="center";this.txtConnecting.style.lineHeight="30px";this.perConnecting=document.createElement("div");this.perConnecting.style.backgroundColor="#1A84E3";
this.perConnecting.style.height="5px";this.perConnecting.style.borderRadius="5px";this.perConnecting.style.width="0%";this.perConnecting.per=0;this.perConnecting.style.position="absolute";this.perConnecting.style.bottom="5px";this.txtConnecting.appendChild(this.perConnecting);this.ui.appendChild(this.txtConnecting)},showLoading:function(){this.txtConnecting.style.display="block";clearInterval(this.itvPerConnection);this.perConnecting.per=0;this.itvPerConnection=setInterval(()=>{this.perConnecting.per+=
.5;90<=this.perConnecting.per&&(this.perConnecting.per=0);this.perConnecting.style.width=this.perConnecting.per+"%"},100)},hideLoading:function(){this.txtConnecting.style.display="none";clearInterval(this.itvPerConnection)},resizeUI:function(a,b){this.ui.style.width=a+"px";this.ui.style.height=b+"px";this.txtConnecting.style.left=(a-260)/2+"px"},startIntv:async function(){cc.log("start intv");this.isStarted=!0;this.showLoading();if("offer"==this.type){var a=(new Date).getTime();this.offer=await this.createOffer();
this.offer.timestamp=a;this.offer.conn=a;this.offer.userid=this.localUserId;this.isWaitingUploadOffer=!0}else clearInterval(this.ofIntv),this.ofIntv=setInterval(()=>{this.getOfferIntv()},this.timeIntv),this.getOfferIntv()},getAnswerIntv:function(){var a=new XMLHttpRequest;a.onreadystatechange=()=>{if(4==a.readyState&&200==a.status)try{var b=JSON.parse(a.responseText);b.timestamp==this.offerTimestamp&&(clearInterval(this.anIntv),this.receiveAnswer(b))}catch(c){cc.log("get answer error")}};a.open("GET",
this.monitor._urlDownload+this.monitor.options.roomid+"/"+this.localUserId+"/answer.txt?t="+(new Date).getTime());a.send()},getOfferIntv:async function(){var a=new XMLHttpRequest;a.onreadystatechange=()=>{if(4==a.readyState&&200==a.status)try{var b=JSON.parse(a.responseText);this.receiveOffer(b)}catch(c){cc.log("get offer error")}};a.open("GET",this.monitor._urlDownload+this.monitor.options.roomid+"/"+this.remoteUserId+"/offer.txt?t="+(new Date).getTime());a.send()},start:function(a,b,c){cc.log("start");
this.isUsed||!a||!b&&"offer"!=c||(this.reset(),this.localUserId=a,this.remoteUserId=b,this.type=c,this.isUsefirestore&&"offer"==this.type&&(this.monitor.firestoreRemoveListener("answer_"+this.localUserId),this.monitor.firestoreAddListener("answer_"+this.localUserId,"answer_"+this.localUserId,(e,g)=>{e?0<g.length&&(e=g[0],0==e.state?this.offer&&this.offer.timestamp.toString()==e.timestamp.toString()&&this.getAnswerIntv():1==e.state&&(cc.log("on get restart "),this.answer&&this.isUsed&&(this.isUsed=
!1,this.start(this.localUserId,this.remoteUserId,this.type)))):(this.isUsefirestore=!1,clearInterval(this.anIntv),this.anIntv=setInterval(()=>{this.getAnswerIntv()},this.timeAnswerIntv))})),this.isUsed=!0,this.initConn(),this.startIntv())},stop:function(){"offer"!=this.type&&this.isUsefirestore&&this.answer&&this.monitor.firestoreWriteDocument("answer_"+this.remoteUserId,"lastest",{state:1,timestamp:this.answer.timestamp});this.reset()},initConn:function(){cc.log("init connection ");this.conn=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});
this.conn.addEventListener("icecandidate",a=>this.onIceCandidate(a));this.conn.addEventListener("iceconnectionstatechange",a=>this.onIceStateChange(a));this.monitor.stream&&this.addStream(this.monitor.stream);this.conn.ontrack=a=>{this.gotRemoteStream(a)}},createOffer:async function(){if(this.conn){try{const a=await this.conn.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1});this.conn.setLocalDescription(a);return{candidate:this.candidate,offer:a}}catch(a){console.log("create offer error "+
a)}return null}},receiveOffer:async function(a){if(null!=this.conn)try{if(!(0<=this.blacklistTimestamp.indexOf(a.timestamp))){this.blacklistTimestamp.push(a.timestamp);clearInterval(this.ofIntv);this.offerReceive=a;this.conn.setRemoteDescription(this.offerReceive.offer);var b=await this.conn.createAnswer();this.conn.setLocalDescription(b);this.answer={candidate:this.candidate,answer:b,timestamp:a.timestamp};this.isWaitingUploadAnswer=!0}}catch(c){cc.log("receiveOffer error "+c)}},receiveAnswer:function(a){if(null!=
this.conn){"offer"==this.type&&(this.answer=a);this.conn.setRemoteDescription(a.answer);for(var b=0;b<a.candidate.length;b++)this.conn.addIceCandidate(a.candidate[b])}},addStream:function(a){"offer"==this.type&&a.getTracks().forEach(b=>{cc.log("add track : ");this.conn.addTrack(b,a)})},gotRemoteStream:function(a){cc.log("gotRemoteStream "+a.streams.length);if(0<a.streams.length){cc.removeAllChildNodes(this.uivideo);for(var b=0;b<a.streams.length;b++){var c=document.createElement("video");this.uivideo.appendChild(c);
c.playsInline=!0;c.muted=!0;c.srcObject=a.streams[b];c.vW=parseInt(this.ui.style.width);c.vH=parseInt(this.ui.style.height);c.onplay=()=>{};c.onresize=()=>{80<c.videoWidth&&60<c.videoHeight&&(this.hideLoading(),console.log("video size "+c.videoWidth+":"+c.videoHeight),c.videoWidth/c.videoHeight<c.vW/c.vH?(c.style.width="",c.style.height="100%"):(c.style.width="100%",c.style.height=""))};c.play()}}},updateBandwidthRestriction:function(a,b){return a=-1===a.indexOf("b=AS:")?a.replace(/c=IN (.*)\r\n/,
"c=IN $1\r\nb=AS:"+b+"\r\n"):a.replace(RegExp("b=AS:.*\r\n"),"b=AS:"+b+"\r\n")},onIceCandidate:function(a){try{a&&a.candidate?(cc.log("onIceCandicate "+JSON.stringify(a.candidate)),this.candidate.push(a.candidate),clearInterval(this.iceIntv),this.iceIntv=setInterval(()=>{clearInterval(this.iceIntv);this.onIceCandidateFinish()},3E3)):(cc.log("on ice null finish get candicate first time"),this.onIceCandidateFinish())}catch(b){cc.log("onIceCandidate exception "+b.message)}},onIceCandidateFinish:function(){this.isWaitingUploadOffer&&
(this.isWaitingUploadOffer=!1,this.offer.candidate=this.candidate,this.monitor.uploadPublicContent(this.monitor._urlOffer,"offer.txt",JSON.stringify(this.offer),(b,c)=>{200==b&&(this.offerTimestamp=this.offer.timestamp,cc.log("upload offer ok"),this.isUsefirestore||(clearInterval(this.anIntv),this.anIntv=setInterval(()=>{this.getAnswerIntv()},this.timeAnswerIntv)))}));if(this.isWaitingUploadAnswer){this.isWaitingUploadAnswer=!1;this.answer.candidate=this.candidate;this.monitor.getPublicUpload(this.monitor.options.roomid,
this.remoteUserId,"answer.txt",b=>{""!=b&&this.monitor.uploadPublicContent(b,"answer.txt",JSON.stringify(this.answer),(c,e)=>{200==c&&cc.log("upload answer ok");this.isUsefirestore&&(cc.log("set firestore"),this.monitor.firestoreWriteDocument("answer_"+this.remoteUserId,"lastest",{state:0,timestamp:this.answer.timestamp}))})});for(var a=0;a<this.offerReceive.candidate.length;a++)this.conn.addIceCandidate(this.offerReceive.candidate[a])}},onIceStateChange:function(a){a=this.conn.iceConnectionState.toString();
cc.log("onIceStateChange state "+a);if("failed"==a||"disconnected"==a||"closed"==a)this.isUsed=!1,this.start(this.localUserId,this.remoteUserId,this.type)},reset:function(){null!=this.conn&&(this.conn.close(),this.conn=null);this.isStarted=this.isUsed=!1;this.type=this.localUserId=this.remoteUserId="";this.offerTimestamp=-1;this.isWaitingUploadOffer=this.isWaitingUploadAnswer=!1;this.answer=this.offerReceive=this.offer=null;this.candidate=[];clearInterval(this.anIntv);clearInterval(this.ofIntv);cc.removeAllChildNodes(this.uivideo)}});aztExam=aztExam||{};aztExam.icon={};
aztExam.svg={iconCheck:'<svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope iron-icon" style="pointer-events: none; display: block; width: 24px; height: 24px;"><g class="style-scope iron-icon"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" class="style-scope iron-icon"></path></g></svg>',iconWarning:'<?xml version="1.0" ?><svg  viewBox="0 0 64 64" style="pointer-events: none; display: block; width: 14px; height: 14px;" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#efcc00;}.cls-2{fill:#353535;}</style></defs><title/><path class="cls-1" d="M30.16,11.51,6.84,51.9a2.13,2.13,0,0,0,1.84,3.19H55.32a2.13,2.13,0,0,0,1.84-3.19L33.84,11.51A2.13,2.13,0,0,0,30.16,11.51Z"/><path class="cls-2" d="M29,46a3,3,0,1,1,3,3A2.88,2.88,0,0,1,29,46Zm1.09-4.66-.76-15h5.26l-.73,15Z"/></svg>',iconCameraOff:'<?xml version="1.0" ?><svg id="Icons" style="enable-background:new 0 0 32 32;" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">.st0{fill:none;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}</style><g><path d="M22.5,20.9l5,3C27.6,24,27.8,24,28,24c0.2,0,0.3,0,0.5-0.1c0.3-0.2,0.5-0.5,0.5-0.9V9c0-0.4-0.2-0.7-0.5-0.9   c-0.3-0.2-0.7-0.2-1,0l-5,3C22.2,11.3,22,11.6,22,12v8C22,20.4,22.2,20.7,22.5,20.9z"/><path d="M29.7,28.3L20,18.6V11c0-1.7-1.3-3-3-3H9.4L3.7,2.3c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l26,26c0.2,0.2,0.5,0.3,0.7,0.3   s0.5-0.1,0.7-0.3C30.1,29.3,30.1,28.7,29.7,28.3z"/><path d="M3,11v10c0,1.7,1.3,3,3,3h11c0.8,0,1.5-0.3,2-0.8L4.3,8.5C3.5,9.1,3,10,3,11z"/></g></svg>',
iconCamera:'<?xml version="1.0" ?><svg id="Icons" style="enable-background:new 0 0 32 32;" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">.st0{fill:none;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}</style><g><path d="M17,8H6c-1.7,0-3,1.3-3,3v10c0,1.7,1.3,3,3,3h11c1.7,0,3-1.3,3-3V11C20,9.3,18.7,8,17,8z"/><path d="M28.5,8.1c-0.3-0.2-0.7-0.2-1,0l-5,3C22.2,11.3,22,11.6,22,12v8c0,0.4,0.2,0.7,0.5,0.9l5,3C27.6,24,27.8,24,28,24   c0.2,0,0.3,0,0.5-0.1c0.3-0.2,0.5-0.5,0.5-0.9V9C29,8.6,28.8,8.3,28.5,8.1z"/></g></svg>',
iconMicOff:'<?xml version="1.0" ?><svg  viewBox="0 0 48 48"  xmlns="http://www.w3.org/2000/svg"><path d="M0 0h48v48H0zm0 0h48v48H0z" fill="none"/><path d="M38 22h-3.4c0 1.49-.31 2.87-.87 4.1l2.46 2.46C37.33 26.61 38 24.38 38 22zm-8.03.33c0-.11.03-.22.03-.33V10c0-3.32-2.69-6-6-6s-6 2.68-6 6v.37l11.97 11.96zM8.55 6L6 8.55l12.02 12.02v1.44c0 3.31 2.67 6 5.98 6 .45 0 .88-.06 1.3-.15l3.32 3.32c-1.43.66-3 1.03-4.62 1.03-5.52 0-10.6-4.2-10.6-10.2H10c0 6.83 5.44 12.47 12 13.44V42h4v-6.56c1.81-.27 3.53-.9 5.08-1.81L39.45 42 42 39.46 8.55 6z"/></svg>',
iconMic:'<?xml version="1.0" ?><svg  viewBox="0 0 48 48"  xmlns="http://www.w3.org/2000/svg"><path d="M24 28c3.31 0 5.98-2.69 5.98-6L30 10c0-3.32-2.68-6-6-6-3.31 0-6 2.68-6 6v12c0 3.31 2.69 6 6 6zm10.6-6c0 6-5.07 10.2-10.6 10.2-5.52 0-10.6-4.2-10.6-10.2H10c0 6.83 5.44 12.47 12 13.44V42h4v-6.56c6.56-.97 12-6.61 12-13.44h-3.4z"/><path d="M0 0h48v48H0z" fill="none"/></svg>',iconRefresh:'<?xml version="1.0" ?><svg style="enable-background:new 0 0 30 30;" version="1.1" viewBox="0 0 30 30" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M22.143,23.365  C20.221,25.008,17.726,26,15,26C8.925,26,4,21.075,4,15" style="fill:none;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-miterlimit:10;"/><path d="M7.857,6.635  C9.779,4.992,12.274,4,15,4c6.075,0,11,4.925,11,11" style="fill:none;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-miterlimit:10;"/><polygon points="26,20 22,14 30,14 "/><polygon points="4,10 8,16 0,16 "/></svg>',
iconClose:'<?xml version="1.0" ?><svg  style="enable-background:new 0 0 612 792;" version="1.1" viewBox="0 0 612 792" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">.st0{clip-path:url(#SVGID_2_);fill:none;stroke:#E44061;stroke-width:45;}.st1{fill:#E44061;}</style><g><g><defs><rect height="512" width="512" x="50" y="140"/></defs><clipPath id="SVGID_2_"><use style="overflow:visible;" xlink:href="#SVGID_1_"/></clipPath><path class="st0" d="M306,629.5c128.8,0,233.5-104.7,233.5-233.5S434.8,162.5,306,162.5S72.5,267.2,72.5,396    S177.2,629.5,306,629.5L306,629.5z"/></g><polygon class="st1" points="348.7,396 448,296.7 405.3,254 306,353.3 206.7,254 164,296.7 263.3,396 164,495.3 206.7,538    306,438.7 405.3,538 448,495.3 348.7,396  "/></g></svg>',
iconGroup:'<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><rect fill="none" height="24" width="24"/><g><path d="M12,12.75c1.63,0,3.07,0.39,4.24,0.9c1.08,0.48,1.76,1.56,1.76,2.73L18,18H6l0-1.61c0-1.18,0.68-2.26,1.76-2.73 C8.93,13.14,10.37,12.75,12,12.75z M4,13c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2s-2,0.9-2,2C2,12.1,2.9,13,4,13z M5.13,14.1 C4.76,14.04,4.39,14,4,14c-0.99,0-1.93,0.21-2.78,0.58C0.48,14.9,0,15.62,0,16.43V18l4.5,0v-1.61C4.5,15.56,4.73,14.78,5.13,14.1z M20,13c1.1,0,2-0.9,2-2c0-1.1-0.9-2-2-2s-2,0.9-2,2C18,12.1,18.9,13,20,13z M24,16.43c0-0.81-0.48-1.53-1.22-1.85 C21.93,14.21,20.99,14,20,14c-0.39,0-0.76,0.04-1.13,0.1c0.4,0.68,0.63,1.46,0.63,2.29V18l4.5,0V16.43z M12,6c1.66,0,3,1.34,3,3 c0,1.66-1.34,3-3,3s-3-1.34-3-3C9,7.34,10.34,6,12,6z"/></g></svg>',
iconLeft:'<svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="gray"><path d="M14 7l-5 5 5 5V7z"/><path d="M24 0v24H0V0h24z" fill="none"/></svg>',iconFullscreen:'<svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="gray"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>',iconExitFullscreen:'<svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="gray"><path d="M0 0h24v24H0z" fill="none"/><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>'};
aztExam.lang={btDone:"XONG",btViewFull:"XEM TO\u00c0N B\u1ed8 L\u1edaP",btViewHistory:"XEM TH\u00d4NG TIN",btCopyLink:"COPY LINK",btBackToList:"DANH S\u00c1CH L\u1edaP",lbDeviceInfo:"TH\u00d4NG TIN THI\u1ebeT B\u1eca",lbOs:"H\u1ec7 \u0111i\u1ec1u h\u00e0nh",msgOsNotSupport:"Ch\u1ee9c n\u0103ng gi\u00e1m s\u00e1t h\u1ed7 tr\u1ee3 tr\u00ean c\u00e1c h\u1ec7 \u0111i\u1ec1u h\u00e0nh : iOS(iphone,ipad) , Android , Window , MAC_OS",msgTeacherOsNotSupport:"Ch\u1ee9c n\u0103ng gi\u00e1m s\u00e1t h\u1ed7 tr\u1ee3 tr\u00ean c\u00e1c h\u1ec7 \u0111i\u1ec1u h\u00e0nh : Window , MAC_OS",
lbBrowser:"Tr\u00ecnh duy\u1ec7t",msgBrowserNotSupportPc:"Ch\u1ee9c n\u0103ng gi\u00e1m s\u00e1t h\u1ed7 tr\u1ee3 phi\u00ean b\u1ea3n m\u1edbi nh\u1ea5tt tr\u00ecnh duy\u1ec7t Chrome,C\u1ed1c c\u1ed1c ,Microsoft Edge ,Firefox tr\u00ean m\u00e1y t\u00ednh",msgBrowserNotSupportAndroid:"Ch\u1ee9c n\u0103ng gi\u00e1m s\u00e1t h\u1ed7 tr\u1ee3 tr\u00ecnh duy\u1ec7t Chrome tr\u00ean h\u1ec7 \u0111i\u1ec1u h\u00e0nh Android .<br/> Copy link v\u00e0 m\u1edf b\u1eb1ng Chrome !",msgBrowserNotSupportIOs:"Ch\u1ee9c n\u0103ng gi\u00e1m s\u00e1t h\u1ed7 tr\u1ee3 tr\u00ecnh duy\u1ec7t Safari  tr\u00ean h\u1ec7 \u0111i\u1ec1u h\u00e0nh iOs .<br/> Copy link v\u00e0 m\u1edf b\u1eb1ng Safari !",
lbCamera:"Camera ",msgCameraNotFound:"Thi\u1ebft b\u1ecb kh\u00f4ng c\u00f3 camera.",msgCameraNotPermission:"Ch\u1ee9c n\u0103ng kh\u00f4ng \u0111\u01b0\u1ee3c c\u1ea5p quy\u1ec1n truy c\u1eadp Camera.<br/><br/><span style='font-style:italic'> Ch\u1ecdn bi\u1ec3u t\u01b0\u1ee3ng kho\u00e1 tr\u00ean \u0111\u1ea7u thanh \u0111\u1ecba ch\u1ec9 , c\u1ea5p quy\u1ec1n truy c\u1eadp camera , t\u1ea3i l\u1ea1i trang website</span>",msgCameraNotPermissionIos:"Ch\u1ee9c n\u0103ng kh\u00f4ng \u0111\u01b0\u1ee3c c\u1ea5p quy\u1ec1n truy c\u1eadp Camera .<br/><br/><span style='font-style:italic'>T\u1ea3i l\u1ea1i trang website , ch\u1ecdn cho ph\u00e9p truy c\u1eadp camera .</span>",
lbMic:"Microphone ",msgMicNotFound:"Thi\u1ebft b\u1ecb kh\u00f4ng c\u00f3 microphone",msgMicNotPermission:"Ch\u1ee9c n\u0103ng kh\u00f4ng \u0111\u01b0\u1ee3c c\u1ea5p quy\u1ec1n truy c\u1eadp Microphone.<br/><br/><span style='font-style:italic'> Ch\u1ecdn bi\u1ec3u t\u01b0\u1ee3ng kho\u00e1 tr\u00ean \u0111\u1ea7u thanh \u0111\u1ecba ch\u1ec9 , c\u1ea5p quy\u1ec1n truy c\u1eadp microphone , t\u1ea3i l\u1ea1i trang website</span>",msgMicNotPermissionIos:"Ch\u1ee9c n\u0103ng kh\u00f4ng \u0111\u01b0\u1ee3c c\u1ea5p quy\u1ec1n truy c\u1eadp Microphone.<br/><br/><span style='font-style:italic'>T\u1ea3i l\u1ea1i trang website , ch\u1ecdn cho ph\u00e9p truy c\u1eadp microphone .</span>",
lbTitleHistory:"TH\u00d4NG TIN C\u00c1 NH\u00c2N ",lbConnectingMedia:"\u0110ang k\u1ebft n\u1ed1i ... !"};aztExam=aztExam||{};
aztExam.monitor=cc.Node.extend({options:null,deviceInfo:null,_isStarted:!1,_numGetMediaUser:0,_isGettingMediaUser:!1,_imageCaptureWidth:0,_imageCaptureHeight:0,_streamType:-1,_urlCurr:"",_urlAnswer:"",_urlOffer:"",_urlDownload:"",ctor:function(){this.initUI();this.reset()},start:function(a){this._isStarted||(this._isStarted=!0,this.reset(),a&&cc.isNumber(a.imageCaptureWidth)&&(this._imageCaptureWidth=a.imageCaptureWidth),a&&cc.isNumber(a.imageCaptureHeight)&&(this._imageCaptureHeight=a.imageCaptureHeight),
a&&a.roomid&&cc.isString(a.roomid)&&(this.options.roomid=a.roomid),a&&a.time&&cc.isNumber(a.time)&&(this.options.time=a.time),a&&a.userlist&&cc.isArray(a.userlist)&&(this.options.userlist=a.userlist.concat([])),a&&a.user&&(a.user.userid&&(this.options.user.userid=a.user.userid),a.user.role&&cc.isNumber(a.user.role)&&(this.options.user.role=a.user.role),a.user.name&&cc.isString(a.user.name)&&(this.options.user.role=a.user.name),a.user.token&&cc.isString(a.user.token)&&(this.options.user.token=a.user.token)),
a&&a.config&&(a.config.urlUpload&&(this.options.config.urlUpload=a.config.urlUpload),a.config.urlDownload&&(this.options.config.urlDownload=a.config.urlDownload),a.config.domainApi&&(this.options.config.domainApi=a.config.domainApi),a.config.numMainView&&(this.options.config.numMainView=a.config.numMainView),a.config.firestore&&(this.options.config.firestore=a.config.firestore),a.config.useFirestore&&(this.options.config.useFirestore=a.config.useFirestore)),a&&a.element&&(this.options.element=a.element),
this.options.config.urlGetPublicForLive=this.options.config.domainApi+this.options.config.urlGetPublicForLive,this.options.config.urlGetListFileForLive=this.options.config.domainApi+this.options.config.urlGetListFileForLive,this.options.config.urlGetTokenForLive=this.options.config.domainApi+this.options.config.urlGetTokenForLive)},loop:function(){this._running||(this._running=!0,this.update(0))},stopLoop:function(){this._running=!1},reset:function(){this.options={};this.options.roomid="";this.options.time=
-1;this.options.userlist=[];this.options.user={token:"",userid:"",role:0,name:""};this.options.config={currentUpdateSize:2,storeUpdateSize:3,domainApi:"https://api.beta.azota.vn/api/",urlUpload:"/fileupload",urlDownload:"/upload/",urlRename:"/rename",urlGetPublicForLive:"s3space/get_public_upload_url_for_live",urlGetListFileForLive:"S3space/get_list_files_for_live",urlGetTokenForLive:"s3space/get_token_for_live",firestore:{apiKey:"AIzaSyC0v2Dh5_7Q1QfE9BsL3hNaLfvjrAavYHQ",authDomain:"aztmonitor.firebaseapp.com",
projectId:"aztmonitor",storageBucket:"aztmonitor.appspot.com",messagingSenderId:"861322107607",appId:"1:861322107607:web:6d76548d360f6f8f372e92"},useFirestore:!0};this.deviceInfo={};this.firestoreRemoveAllListener()},showDeviceUI:function(a){if(a){try{this.deviUI&&(document.body.removeChild(this.deviUI),this.deviUI=null)}catch(r){cc.log("error remove deviUI")}var b=(window.innerWidth-20)/500;0==b&&(b=1);1<=b&&(b=1);var c=(window.innerHeight-50)/b;this.deviUI=this.findDom(document.createElement("div"));
this.deviUI.css("position","absolute");this.deviUI.css("transform-origin","0% 0%");this.deviUI.css("transform","scale(0.01)");this.deviUI.css("width","500px");this.deviUI.css("height",Math.floor(c)+"px");this.deviUI.css("left",Math.floor((window.innerWidth-500*b)/2)+"px");this.deviUI.css("top",Math.floor((window.innerHeight-c*b)/2)+"px");this.deviUI.css("background-color","white");this.deviUI.css("font-family","sans-serif");this.deviUI.css("font-size","18px");this.deviUI.css("box-shadow","0 2px 2px 0 rgb(0 0 0 / 14%), 0 3px 1px -2px rgb(0 0 0 / 12%), 0 1px 5px 0 rgb(0 0 0 / 20%)");
this.deviUI.css("z-index",999999999);document.body.appendChild(this.deviUI);anime({targets:this.deviUI,scale:b,easing:"easeInOutExpo",duration:1E3});b=this.findDom(document.createElement("div"));b.css("width","100%");b.css("height","60px");b.css("border-bottom","1px solid #CCCCCC");this.deviUI.appendChild(b);var e=this.findDom(document.createElement("span"));e.css("color","gray");e.css("display","flex");e.css("width","70%");e.css("height","100%");e.css("float","left");e.css("padding-left","20px");
e.css("align-items","center");e.innerHTML=aztExam.lang.lbDeviceInfo;b.appendChild(e);this.btDone=this.createButton(100,40,aztExam.lang.btDone,"#1A84E3",16);this.btDone.css("float","right");this.btDone.css("margin-right","10px");this.btDone.css("margin-top","10px");b.appendChild(this.btDone);this.btDone.addTouch(r=>{anime({targets:this.deviUI,scale:.01,easing:"easeInOutExpo",duration:500,complete:()=>{this.deviUI.css("display","none")}})});b=this.findDom(document.createElement("div"));b.css("width",
"100%");b.css("height",c-60+"px");b.css("overflow-x","hidden");b.css("overflow-y","scroll");this.deviUI.appendChild(b);c=this.findDom(document.createElement("div"));c.css("width","100%");c.css("height","60px");c.css("margin-top","10px");c.css("background",a.osSupport?"#90ec90":"#ec9090");c.css("display","flex");c.css("align-items","center");c.css("padding-left","20px");c.css("color","#333333");c.innerHTML=aztExam.lang.lbOs+" "+a.osName+"  "+a.osVersion;b.appendChild(c);c=this.findDom(document.createElement("div"));
c.css("width","90%");c.css("height","auto");c.css("text-align","center");c.css("margin-top","10px");c.css("margin-left","5%");c.innerHTML="student"==this.role()?aztExam.lang.msgOsNotSupport:aztExam.lang.msgTeacherOsNotSupport;c.css("display",a.osSupport?"none":"block");b.appendChild(c);c=this.findDom(document.createElement("div"));c.css("width","100%");c.css("height","60px");c.css("margin-top","10px");c.css("background",a.browserSupport?"#90ec90":"#ec9090");c.css("display","flex");c.css("align-items",
"center");c.css("padding-left","20px");c.css("color","#333333");c.css("white-space","nowrap");c.innerHTML=aztExam.lang.lbBrowser+" "+a.browser.name+" "+a.browser.version;b.appendChild(c);c=this.findDom(document.createElement("div"));c.css("width","90%");c.css("height","auto");c.css("text-align","center");c.css("margin-top","10px");c.css("padding-left","5%");c.innerHTML=aztExam.lang.msgBrowserNotSupportPc;a.isAndroid?c.innerHTML=aztExam.lang.msgBrowserNotSupportAndroid:a.isIOs&&(c.innerHTML=aztExam.lang.msgBrowserNotSupportIOs);
c.css("display",a.browserSupport?"none":"block");b.appendChild(c);a.browserSupport||!a.isIOs&&!a.isAndroid||(c=this.createButton(160,40,aztExam.lang.btCopyLink,"#1A84E3",16),c.css("margin-left","170px"),c.css("margin-top","10px"),c.css("display","flex"),b.appendChild(c));c=this.findDom(document.createElement("div"));c.css("width","100%");c.css("height","60px");c.css("margin-top","10px");c.css("background",a.hasWebcam&&a.isWebsiteHasWebcamPermissions?"#90ec90":"#ec9090");c.css("display","flex");c.css("align-items",
"center");c.css("padding-left","20px");c.css("color","#333333");c.css("white-space","nowrap");c.innerHTML=aztExam.lang.lbCamera+" ("+a.videoInputDevices.length+")";b.appendChild(c);c=this.findDom(document.createElement("div"));c.css("width","90%");c.css("height","auto");c.css("text-align","center");c.css("margin-top","10px");c.css("padding-left","5%");c.css("display",a.hasWebcam&&a.isWebsiteHasWebcamPermissions?"none":"block");a.hasWebcam?a.isWebsiteHasWebcamPermissions||(c.innerHTML=a.isIOs?aztExam.lang.msgCameraNotPermissionIos:
aztExam.lang.msgCameraNotPermission):c.innerHTML=aztExam.lang.msgCameraNotFound;b.appendChild(c);if(a.isWebsiteHasWebcamPermissions){c=document.createElement("video");c.width=80;c.height=60;c.style.margin="10px";c.style.float="left";c.muted=!0;c.playsInline=!0;c.classList.add("azt_devi_video_preview");this.stream&&(c.srcObject=this.stream,c.play());b.appendChild(c);var g=document.createElement("div");g.style.width="390px";g.style.height="auto";g.style.float="left";b.appendChild(g);c=a.videoInputDevices;
for(e=0;e<c.length;e++){var h=this.createListCheck("azt_cam_item",e,c[e].label,e==this.deviceInfo.videoInputIndex?!0:!1,c[e]);h.addTouch(r=>{r=parseInt(r.target.getAttribute("azt_cam_item_index"));r!=this.deviceInfo.videoInputIndex&&this.getMediaUser(r,this.deviceInfo.audioInputIndex)});g.appendChild(h)}}c=this.findDom(document.createElement("div"));c.css("width","100%");c.css("height","60px");c.css("margin-top","10px");c.css("background",a.hasMicrophone&&a.isWebsiteHasMicrophonePermissions?"#90ec90":
"#ec9090");c.css("display","flex");c.css("align-items","center");c.css("padding-left","20px");c.css("color","#333333");c.css("white-space","nowrap");c.innerHTML=aztExam.lang.lbMic+" ("+a.audioInputDevices.length+")";b.appendChild(c);g=this.findDom(document.createElement("div"));g.css("width","90%");g.css("height","auto");g.css("text-align","center");g.css("margin-top","10px");g.css("padding-left","5%");g.css("padding-left","5%");g.css("display",a.hasMicrophone&&a.isWebsiteHasMicrophonePermissions?
"none":"block");a.hasMicrophone?a.isWebsiteHasMicrophonePermissions||(g.innerHTML=a.isIOs?aztExam.lang.msgMicNotPermissionIos:aztExam.lang.msgMicNotPermission):g.innerHTML=aztExam.lang.msgMicNotFound;if(a.isWebsiteHasMicrophonePermissions)for(c=a.audioInputDevices,e=0;e<c.length;e++)h=this.createListCheck("azt_mic_item",e,c[e].label,e==this.deviceInfo.audioInputIndex?!0:!1,c[e]),h.addTouch(r=>{r=parseInt(r.target.getAttribute("azt_mic_item_index"));r!=this.deviceInfo.audioInputIndex&&this.getMediaUser(this.deviceInfo.videoInputIndex,
r)}),b.appendChild(h);b.appendChild(g)}},collectInfo:function(a){DetectRTC.load(()=>{this.deviceInfo.osName=DetectRTC.osName;this.deviceInfo.osVersion=DetectRTC.osVersion;this.deviceInfo.browser=DetectRTC.browser;this.deviceInfo.osSupport=this.checkOsSupport(this.deviceInfo);this.deviceInfo.browserSupport=this.checkBrowserSuppor(this.deviceInfo);this.deviceInfo.hasWebcam=DetectRTC.hasWebcam;this.deviceInfo.hasMicrophone=DetectRTC.hasMicrophone;this.deviceInfo.isWebsiteHasWebcamPermissions=DetectRTC.isWebsiteHasWebcamPermissions;
this.deviceInfo.isWebsiteHasMicrophonePermissions=DetectRTC.isWebsiteHasMicrophonePermissions;this.deviceInfo.isWebRTCSupported=DetectRTC.isWebRTCSupported;this.deviceInfo.videoInputDevices=DetectRTC.videoInputDevices;this.deviceInfo.audioInputDevices=DetectRTC.audioInputDevices;if(0==this._numGetMediaUser){if(!this.deviceInfo.osSupport||!this.deviceInfo.browserSupport){this.showDeviceUI(this.deviceInfo);return}if("teacher"==this.role()){a&&a();return}DetectRTC.hasWebcam||DetectRTC.hasMicrophone?
this.getMediaUser(DetectRTC.hasWebcam?0:-1,DetectRTC.hasMicrophone?0:-1):this.showDeviceUI(this.deviceInfo)}else if(1==this._numGetMediaUser)0>this._streamType&&this.showDeviceUI(this.deviceInfo);else if(this.deviUI){for(var b=this.deviUI.getElementsByClassName("azt_cam_item"),c=0;c<b.length;c++){var e=b[c].getElementsByClassName("check_icon");e[0].style.display=c==this.deviceInfo.videoInputIndex?"block":"none"}b=this.deviUI.getElementsByClassName("azt_mic_item");for(c=0;c<b.length;c++)e=b[c].getElementsByClassName("check_icon"),
e[0].style.display=c==this.deviceInfo.audioInputIndex?"block":"none"}a&&a()})},checkOsSupport:function(a){var b=a.osName.toLowerCase();if(0<=b.indexOf("window")||0<=b.indexOf("mac"))return a.isPc=!0;if("student"==this.role()){if(0<=b.indexOf("android"))return a.isAndroid=!0;if(0<=b.indexOf("ios")||b.indexOf("ipad"))return a.isIOs=!0}return!1},checkBrowserSuppor:function(a){var b=a.osName.toLowerCase();a=a.browser.name.toLowerCase();if(0<=b.indexOf("window")||0<=b.indexOf("mac"))if(0<=a.indexOf("chrome")||
0<=a.indexOf("edge")||0<=a.indexOf("firefox")||0<=a.indexOf("coccoc"))return!0;return"student"==this.role()&&(0<=b.indexOf("android")&&0<=a.indexOf("chrome")||(0<=b.indexOf("ios")||0<=b.indexOf("ipad"))&&0<=a.indexOf("safari"))?!0:!1},stopAllPreview:function(){this.stream&&this.stream.getTracks().forEach(a=>{a.stop()})},updateAllPreview:function(){if(this.deviUI){var a=this.deviUI.getElementsByClassName("azt_devi_video_preview")[0];a&&this.stream&&(a.srcObject=this.stream,a.play())}this.stream&&this.videoReview&&
(this.videoReview.srcObject=this.stream,this.videoReview.play())},getMediaUser:function(a,b,c){if(!(0>a&&0>b||this._isGettingMediaUser||a>=this.deviceInfo.videoInputDevices.length||b>=this.deviceInfo.audioInputDevices.length)){var e=!1,g=!1;cc.log("get media user "+a+":"+b);if(0<=a){cc.log("video index");e=this.deviceInfo.videoInputDevices[a].deviceId;var h=1280,r=720;this.isMobile()&&(h=640,r=480);e=c?{deviceId:e?{exact:e}:void 0}:{deviceId:e?{exact:e}:void 0,width:{max:h,min:h},height:{max:r,min:r}};
cc.log("video contrainst")}0<=b&&(cc.log("audio index"),c=this.deviceInfo.audioInputDevices[b].deviceId,g={deviceId:c?{exact:c}:void 0},cc.log("audio contrainst"));cc.log("media constraints "+JSON.stringify(e));this._isGettingMediaUser=!0;this.stopAllPreview();navigator.mediaDevices.getUserMedia({audio:g,video:e}).then(v=>{cc.log("ongetstream");this.gotStream(v,a,b)}).then().catch(this.handleError)}},gotStream:function(a,b,c){cc.log("on getStream");this.deviceInfo.videoInputIndex=b;this.deviceInfo.audioInputIndex=
c;this.stream=a;0<=b&&(this.videoWidth=this.stream.getVideoTracks()[0].getSettings().width,this.videoHeight=this.stream.getVideoTracks()[0].getSettings().height,this.videoHeight=0==this.videoHeight?240:this.videoHeight,this.videoWidth=0==this.videoWidth?320:this.videoWidth);0<=b&&0<=c?this._streamType=0:0<=b?this._streamType=1:0<=c&&(this._streamType=2);this.updateAllPreview();this._numGetMediaUser++;this.collectInfo();this._isGettingMediaUser=!1},handleError:function(a){},update:function(a){},uploadContent:function(a,
b,c,e){if(a&&b){c||(c=this.options.user.userid);b=new Blob([b],{type:"text/plain"});var g=new File([b],a),h=new XMLHttpRequest;b=new FormData;b.append("file",g);a="roomid="+this.options.roomid+"&userid="+c+"&filename="+a;h.onreadystatechange=function(){4==this.readyState&&(cc.log("upload success"),e&&e(this.status,h.responseText))};h.open("POST",this.options.config.urlUpload+"?"+a);h.send(b)}},renameContent:function(a,b,c,e){if(a&&b){c||(c=this.options.user.userid);var g=new XMLHttpRequest;a="roomid="+
this.options.roomid+"&userid="+c+"&filenameold="+a+"&filenamenew="+b;g.onreadystatechange=function(){4==this.readyState&&e&&e(this.status,g.responseText)};g.open("POST",this.options.config.urlRename+"?"+a);g.send()}},getPublicUpload:function(a,b,c,e){var g=new XMLHttpRequest;a=encodeURI(this.options.config.urlGetPublicForLive+"?examHashId="+(a+"&userId="+b+"&file_name="+c+"&file_size=100000&minetype=text/plain"));g.open("GET",a);g.setRequestHeader("Authorization","Bearer "+this.options.user.token);
g.onreadystatechange=function(){if(4==g.readyState&&200==g.status)try{var h=JSON.parse(g.responseText).data.upload_url,r=JSON.parse(g.responseText).data.url;cc.log("getPublicUpload "+h+":"+r);e(h,r)}catch(v){e("")}};g.send()},uploadPublicContent:function(a,b,c,e){c=new Blob([c],{type:"text/plain"});b=new File([c],b);c=new XMLHttpRequest;c.open("PUT",a);c.setRequestHeader("Content-Type","text/plain");c.setRequestHeader("x-amz-acl","public-read");c.onreadystatechange=function(){4==this.readyState&&
e&&e(this.status,this.responseText)};c.send(b)},getTokenForLive:function(a,b){var c=new XMLHttpRequest;a=encodeURI(this.options.config.urlGetTokenForLive+"?examHashId="+a);c.open("GET",a);c.setRequestHeader("Authorization","Bearer "+this.options.user.token);c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status)try{var e=JSON.parse(c.responseText).data;b(e)}catch(g){b("")}else b("")};c.send()},getListFile:function(a,b){var c=new XMLHttpRequest;a=encodeURI(this.options.config.urlGetListFileForLive+
"?examHashId="+(a+"&userId="+b));c.open("GET",a);c.setRequestHeader("Authorization","Bearer "+this.options.user.token);c.onreadystatechange=function(){if(4==c.readyState&&200==c.status)try{cc.log("get list file  : "+c.responseText)}catch(e){}};c.send()},initFirestore:function(a){if(this.options.config.useFirestore&&this.options.config.firestore){if(!window.firebase)var b=["https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js","https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js",
"https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"];cc.loadJs(b,()=>{const c=firebase.initializeApp(this.options.config.firestore);firebase.auth().signInAnonymously().then(()=>{cc.log("signIn anonymous");a&&a(c)}).catch(e=>{a&&a(null)})})}},firestoreAddListener:function(a,b,c){this.firebaseApp&&b&&""!=b.trim()&&(this.firestoreListenerDoc||(this.firestoreListenerDoc={}),this.firestoreListenerDoc[a]&&this.firestoreListenerDoc[a].call(),this.firestoreListenerDoc[a]=this.firebaseApp.firestore().collection(b).onSnapshot(e=>
{e=e.docs.map(g=>({id:g.id,...g.data()}));console.log("receive firestore : ",JSON.stringify(e));c&&c(!0,e)},e=>{c&&c(!1)}))},firestoreReadDocument:function(a,b){},firestoreWriteDocument:function(a,b,c,e){this.firebaseApp&&b&&""!=b.trim()&&c&&this.firebaseApp.firestore().collection(a).doc(b).set(c).then(()=>{console.log("Document created")}).catch(g=>{console.log("Write document error")})},firestoreRemoveListener:function(a){this.firebaseApp&&this.firestoreListenerDoc&&this.firestoreListenerDoc[a]&&
this.firestoreListenerDoc[a].call()},firestoreRemoveAllListener:function(){if(this.firestoreListenerDoc)for(var a in this.firestoreListenerDoc)this.firestoreListenerDoc[a].call()},createButton:function(a,b,c,e,g){var h=this.findDom(document.createElement("div"));h.css("border-radius","5px");h.css("width",a+"px");h.css("height",b+"px");h.css("background-color",e);h.css("display","flex");h.css("align-items","center");h.css("justify-content","center");h.css("color","white");h.css("cursor","pointer");
h.css("font-size",g+"px");h.css("user-select","none");h.innerHTML=c;return h},createListCheck:function(a,b,c,e,g){var h=this.findDom(document.createElement("div"));h.css("width","90%");h.css("margin-left","5%");h.css("height","50px");h.css("display","flex");h.css("align-items","center");h.css("justify-content","space-between");h.css("flex-direction","row");h.css("border-bottom","1px solid #AAAAAA");h.css("white-space","nowrap");h.css("cursor","pointer");h.classList.add(a);h.setAttribute(a+"_index",
b);h.innerHTML=c;h.info=g;a=document.createElement("div");a.classList.add("check_icon");a.innerHTML=aztExam.svg.iconCheck;a.style.display=e?"block":"none";h.appendChild(a);return h},getLocalStorage:function(a){try{if(localStorage)return localStorage.getItem(a)}catch(b){}cc.log("not support localStorage");return""},setLocalStorage:function(a,b){try{if(localStorage)return localStorage.setItem(a,b),!0}catch(c){}cc.log("not support localStorage");return!1},getParameterByName:function(a,b=window.location.href){a=
a.replace(/[\[\]]/g,"\\$&");return(a=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(b))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},hasWebcamStream:function(){return 0==this._streamType||1==this._streamType?!0:!1},hasMicrophoneStream:function(){return 0==this._streamType||2==this._streamType?!0:!1},isMobile:function(){return 0>this.deviceInfo.osName.toLowerCase().indexOf("window")&&0>this.deviceInfo.osName.toLowerCase().indexOf("mac")?!0:!1},role:function(){return""},version:function(){return"1.2"}});
function SoundMeter(a){this.context=a;this.clip=this.slow=this.instant=0;this.script=a.createScriptProcessor(2048,1,1);const b=this;this.script.onaudioprocess=function(c){c=c.inputBuffer.getChannelData(0);let e,g=0,h=0;for(e=0;e<c.length;++e)g+=c[e]*c[e],.99<Math.abs(c[e])&&(h+=1);b.instant=Math.sqrt(g/c.length);b.slow=.95*b.slow+.05*b.instant;b.clip=h/c.length}}
SoundMeter.prototype.connectToSource=function(a,b){console.log("SoundMeter connecting");try{this.mic=this.context.createMediaStreamSource(a),this.mic.connect(this.script),this.script.connect(this.context.destination),"undefined"!==typeof b&&b(null)}catch(c){console.error(c),"undefined"!==typeof b&&b(c)}};SoundMeter.prototype.stop=function(){console.log("SoundMeter stopping");this.mic.disconnect();this.script.disconnect()};aztExam=aztExam||{};
aztExam.monitorStudent=aztExam.monitor.extend({_hasVideoReviewPlaying:!1,_hasExtentCamera:!1,_firstUpload:!0,_queueUpload:null,_uploadIntv:9E3,w:void 0,ctor:function(){cc.log("init ver= "+this.version());this._super()},start:function(a){cc.log("start : "+this._isStarted);this._isStarted||(this._super(a),cc.log("start student: "+this._isStarted),a.element&&this.appendPreview(),this.initUrlUploadPublic(()=>{cc.log("init url finish ");cc.log("url download "+this._urlDownload);cc.log("url upload offer "+this._urlOffer);
cc.log("url upload curr "+this._urlCurr);setTimeout(()=>this.initFirestore(b=>{this.firebaseApp=b;this.startCollection()}),100)}))},startCollection:function(){this.collectInfo(()=>{this.isMobile()?(this._imageCaptureHeight=120,this._imageCaptureWidth=90):(this._imageCaptureWidth=142,this._imageCaptureHeight=80);this.previewWidth=this.options.config&&this.options.config.previewWidth?parseInt(this.options.config.previewWidth):this._imageCaptureWidth;this.previewHeight=this.options.config&&this.options.config.previewHeight?
parseInt(this.options.config.previewHeight):this._imageCaptureHeight;this.preview.style.width=this.previewWidth+"px";this.preview.style.height=this.previewHeight+"px";this.volumeMeter.height=this.previewHeight;var a=this.options.config;this.canvasPreview.width=this._imageCaptureWidth;this.canvasPreview.height=this._imageCaptureHeight;this.canvasDraw.width=a.storeUpdateSize*this._imageCaptureWidth;this.canvasDraw.height=a.storeUpdateSize*this._imageCaptureHeight;this.canvasDraw.cols=a.storeUpdateSize;
this.canvasDraw.rows=a.storeUpdateSize;this.canvasDraw.imageWidth=this._imageCaptureWidth;this.canvasDraw.imageHeight=this._imageCaptureHeight;this.canvasDrawCurr.width=a.currentUpdateSize*this._imageCaptureWidth;this.canvasDrawCurr.height=a.currentUpdateSize*this._imageCaptureHeight;this.canvasDrawCurr.cols=a.currentUpdateSize;this.canvasDrawCurr.rows=a.currentUpdateSize;this.canvasDrawCurr.imageWidth=this._imageCaptureWidth;this.canvasDrawCurr.imageHeight=this._imageCaptureHeight;this._uploadIntv=
a.currentUpdateSize*a.currentUpdateSize*1E3+1E3;this.loop()})},reset:function(){this._super();this._firstUpload=!0;this._hasVideoReviewPlaying=this._hasExtentCamera=!1;this._queueUpload=[]},stop:function(){cc.log("start stop: "+this._isStarted);this.stream&&(this.stream.getTracks().forEach(a=>{a.stop()}),this.stream=null);this.stopLoop();this.reset()},appendPreview:function(){clearInterval(this.intvAppendPreview);this.intvAppendPreview=setInterval(()=>{null!=document.getElementById(this.options.element)&&
(document.getElementById(this.options.element).appendChild(this.preview),this.preview.style.display="block",clearInterval(this.intvAppendPreview))},500)},initUI:function(){this.preview=this.findDom(document.createElement("div"));this.preview.style.overflow="hidden";this.preview.style.borderRadius="8px";this.preview.style.backgroundColor="gray";this.preview.style.position="absolute";this.preview.style.left="0px";this.preview.style.top="0px";this.preview.style.zIndex="9999999";this.preview.style.transformOrigin=
"0% 0%";this.preview.style.width=this._imageCaptureWidth+"px";this.preview.style.height=this._imageCaptureHeight+"px";this.setDragEnabledDom(this.preview,!0);this.preview.addTouch(a=>{0<this._numGetMediaUser&&this.showDeviceUI(this.deviceInfo)});this.volumeMeter=document.createElement("canvas");this.volumeMeter.width=6;this.volumeMeter.height=this._imageCaptureHeight;this.volumeMeter.style.position="absolute";this.volumeMeter.style.border="none";this.ctxVolumeMeter=this.volumeMeter.getContext("2d");
this.volumeMeter.style.right="0px";this.volumeMeter.style.zIndex="9999999";this.preview.appendChild(this.volumeMeter);this.videoReview=document.createElement("video");this.videoReview.muted=!0;this.videoReview.playsInline=!0;this.videoReview.style.position="absolute";this.videoReview.style.top="0px";this.videoReview.style.left="0px";this.videoReview.onplay=()=>{this._hasVideoReviewPlaying=!0;this.updatePreviewUI()};this.videoReview.onresize=()=>{this.updatePreviewUI()};this.preview.appendChild(this.videoReview);
this.previewWarning=this.findDom(document.createElement("div"));this.previewWarning.style.width="100%";this.previewWarning.style.height="100%";this.previewWarning.style.backgroundColor="red";this.previewWarning.style.opacity=.2;this.previewWarning.style.position="absolute";this.previewWarning.style.top="0px";this.previewWarning.style.left="0px";this.previewWarning.lastWarning=!1;this.previewWarning.style.numFound=-1;this.previewWarning.style.display="none";this.preview.appendChild(this.previewWarning);
this.canvasPreview=document.createElement("canvas");this.canvasPreview.style.borderRadius="8px";this.ctxPreview=this.canvasPreview.getContext("2d");this.canvasDraw=document.createElement("canvas");this.canvasDraw.numDraw=0;this.canvasDraw.timestamp=[];this.canvasDraw.warning=[];this.ctxDraw=this.canvasDraw.getContext("2d");this.canvasDrawCurr=document.createElement("canvas");this.canvasDrawCurr.numDraw=0;this.canvasDrawCurr.timestamp=[];this.canvasDrawCurr.warning={};this.canvasDrawCurr.isWarning=
!1;this.ctxDrawCurr=this.canvasDrawCurr.getContext("2d");this.ctxDrawCurr.fontSize="18px Arial";this.ctxDrawCurr.fillStyle="red";this.divLog=document.createElement("div");this.divLog.style.position="fixed";this.divLog.style.width="100%";this.divLog.style.height="auto";this.divLog.style.bottom="0px";this.currDiv=document.createElement("div")},updatePreviewUI:function(){this._hasVideoReviewPlaying&&this._hasExtentCamera||!this._hasVideoReviewPlaying||(this.previewWidth/this.previewHeight>this.videoReview.videoWidth/
this.videoReview.videoHeight?(this.videoReview.style.width="100%",this.videoReview.style.height="auto"):(this.videoReview.style.width="auto",this.videoReview.style.height="100%"));this.isMobile()&&(this.preview.style.transform="scale(0.4)")},gotStream:function(a,b,c){this._super(a,b,c);this.hasWebcamStream()&&this.initEyeDetection();this.hasMicrophoneStream()&&setTimeout(()=>{this.initSoundMeter()},1E3);this.initConn()},handleError:function(a){var b=aztExam.MonitorStudent.getInstance();b._numGetMediaUser++;
cc.log("navigator.MediaDevices.getUserMedia error: ",a.message,a.name,b._numGetMediaUser);b._isGettingMediaUser=!1;1==b._numGetMediaUser?b.getMediaUser(0,0,!0):(cc.log("show collection info"),b._numGetMediaUser--,b.collectInfo(),b.initConn())},initEyeDetection:function(){this.w||("undefined"!==typeof Worker?("undefined"==typeof this.w&&(this.w=new Worker("/assets/js/worker.js?ver=1.0")),this.w.onmessage=a=>{a=a.data;"opencvloaded"==a.cmd&&cc.log("opencv_loaded");if("processimage"==a.cmd){(new Date).getTime();
var b=0<a.obj.foundFace.length?a.obj.foundFace.length:0<a.obj.foundEyes.length?1:0;0<=this.previewWarning.numFound&&(1<b?(this.previewWarning.style.display="block",this.previewWarning.style.backgroundColor="yellow"):0==b&&0==this.previewWarning.numFound?(this.previewWarning.style.display="block",this.previewWarning.style.backgroundColor="red"):this.previewWarning.style.display="none",(1<b||0==b&&0==this.previewWarning.numFound)&&a.obj.startTime==this.canvasDrawCurr.startTime&&(this.canvasDrawCurr.warning[a.obj.index]=
b,this.canvasDrawCurr.isWarning=!0));this.previewWarning.numFound=b}}):(cc.log("browser not support wasm"),this.divLog.innerHTML="browser not support wasm"))},initSoundMeter:function(){if(0==this._streamType||2==this._streamType)try{window.AudioContext=window.AudioContext||window.webkitAudioContext,null==this.audioContext&&(this.audioContext=new AudioContext),null!=this.soundMeter&&this.soundMeter.stop(),this.soundMeter=new SoundMeter(this.audioContext),this.soundMeter.connectToSource(this.stream,
a=>{a||(this.volumeMeter.avg=-1,this.volumeMeter.totalPlus=0,this.volumeMeter.count=0,this.volumeMeter.minVal=1,this.volumeMeter.arrVal=[],this.volumeMeter.lastVal=1,setInterval(()=>{this.ctxVolumeMeter.fillStyle="#333333";this.ctxVolumeMeter.fillRect(0,0,this.volumeMeter.width,this.volumeMeter.height);this.divLog.innerHTML=this.soundMeter.instant.toFixed(5);var b=Number(this.soundMeter.instant.toFixed(5));0>this.volumeMeter.avg?10>this.volumeMeter.count?(this.volumeMeter.count++,this.volumeMeter.totalPlus+=
b):(this.volumeMeter.avg=this.volumeMeter.totalPlus/this.volumeMeter.count,this.volumeMeter.avg=5E-4<this.volumeMeter.avg?.001:1E-4,cc.log("volume avg "+this.volumeMeter.avg),this.deviceInfo.VolumeAvg=this.volumeMeter.avg):(b=.4*.1*b/this.volumeMeter.avg,b=.2>b?.2:b,b=.8<b?.8:b,this.ctxVolumeMeter.fillStyle=.6<b?"#FF0000":"#0af50a",this.ctxVolumeMeter.fillRect(0,(1-b)*this.volumeMeter.height,this.volumeMeter.width,this.volumeMeter.height),this.canvasPreview.volumeMeterVal=b)},400))})}catch(a){}},
update:function(a){a=(new Date).getTime();this._lastTimeDraw?a>this._lastTimeDraw&&1E3<a-this._lastTimeDraw&&(this.processDraw(),this._lastTimeDraw=a):this._lastTimeDraw=a;this._running&&window.requestAnimationFrame(b=>{this.update(b)})},processUpload:function(){if(0<this._queueUpload.length){var a=this._queueUpload.shift();this.uploadPublicContent(this._urlCurr,"curr.txt",a,b=>{cc.log("upload curr ok "+b)})}},processDraw:function(){if(this._running){this.ctxPreview.fillStyle="black";this.ctxPreview.fillRect(0,
0,this.canvasPreview.width,this.canvasPreview.height);var a=(new Date).getTime();if((!this._hasVideoReviewPlaying||!this._hasExtentCamera)&&this._hasVideoReviewPlaying){var b=this._imageCaptureHeight/this.videoHeight;var c=b*this.videoWidth;b*=this.videoHeight;this.ctxPreview.drawImage(this.videoReview,0,0,this.videoWidth,this.videoHeight,Math.floor((this._imageCaptureWidth-c)/2),0,c,b);c=(new Date(a)).toLocaleString();this.ctxPreview.fillStyle="red";this.ctxPreview.font="10px Arial";this.ctxPreview.fillText(c,
0,b-10);this.canvasPreview.volumeMeterVal&&(this.ctxPreview.fillStyle="#333333",c=this.volumeMeter.width-3,this.ctxPreview.fillRect(this.canvasPreview.width-c,0,c,this.canvasPreview.height),b=this.canvasPreview.volumeMeterVal,this.ctxPreview.fillStyle=.6<b?"#e11d1d":"#41b545",this.ctxPreview.fillRect(this.canvasPreview.width-c,(1-b)*this.canvasPreview.height,c,this.canvasPreview.height))}c=this.options.config;b=c.currentUpdateSize;this.ctxDrawCurr.drawImage(this.canvasPreview,0,0,this.canvasPreview.width,
this.canvasPreview.height,Math.floor(this.canvasDrawCurr.numDraw%b)*this.canvasDrawCurr.imageWidth,Math.floor(this.canvasDrawCurr.numDraw/b)*this.canvasDrawCurr.imageHeight,this.canvasDrawCurr.imageWidth,this.canvasDrawCurr.imageHeight);0==this.canvasDrawCurr.numDraw&&(this.canvasDrawCurr.startTime=a);this.w&&(this.hasWebcamStream()||this._hasExtentCamera)&&(this._startProcessImage=a,this.w.postMessage({cmd:"processimage",obj:{isMobile:this.isMobile(),startTime:this.canvasDrawCurr.startTime,index:this.canvasDrawCurr.numDraw,
timestamp:a,imagedata:this.ctxPreview.getImageData(0,0,this.canvasPreview.width,this.canvasPreview.height)}}));this.canvasDrawCurr.numDraw++;this.canvasDrawCurr.timestamp.push(a);this.canvasDrawCurr.numDraw==b*b&&(cc.log("upload "+this.canvasDrawCurr.numDraw+":"+c.currentUpdateSize+":"+c.storeUpdateSize),this._queueUpload.push(this.toStrCanvasDraw(this.canvasDrawCurr)),this.processUpload(),c.currentUpdateSize<c.storeUpdateSize&&(c.currentUpdateSize++,this.canvasDrawCurr.width=c.currentUpdateSize*
this.canvasDrawCurr.imageWidth,this.canvasDrawCurr.height=c.currentUpdateSize*this.canvasDrawCurr.imageHeight,this.canvasDrawCurr.cols=c.currentUpdateSize,this.canvasDrawCurr.rows=c.currentUpdateSize,this._uploadIntv=c.currentUpdateSize*c.currentUpdateSize*1E3+2),this.ctxDrawCurr.clearRect(0,0,this.canvasDrawCurr.width,this.canvasDrawCurr.height),this.canvasDrawCurr.numDraw=0,this.canvasDrawCurr.timestamp=[],this.canvasDrawCurr.warning={},this.canvasDrawCurr.isWarning=!1)}},toStrCanvasDraw:function(a){(new Date).getTime();
var b=a.toDataURL("image/jpeg",15),c=(new Date).getTime();a={v:this.version(),c:a.cols,r:a.rows,numImage:a.numDraw,w:a.imageWidth,h:a.imageHeight,deviceInfo:this.deviceInfo,startTime:a.startTime,time:c,timeStr:(new Date).toUTCString(),timestamp:this.canvasDrawCurr.timestamp,warning:this.canvasDrawCurr.warning,isWarning:this.canvasDrawCurr.isWarning};a=JSON.stringify(a);c=a.length;for(var e=c.toString(),g=10;g>c.toString().length;g--)e="0"+e;return b+a+e},initConn:function(){cc.log("initConn");null==
this.conn&&(this.conn=new aztExam.RTCConnection(this),this.conn.initConn(),this.conn.start(this.options.user.userid,"","offer"))},uploadCurr:function(){},initUrlUploadPublic:function(a){this.getPublicUpload(this.options.roomid,this.options.user.userid,"curr.txt",(b,c)=>{b&&""!=b?(this._urlCurr=b,b=c.indexOf(this.options.roomid),0<=b&&(this._urlDownload=c.substr(0,b)),this.getPublicUpload(this.options.roomid,this.options.user.userid,"offer.txt",e=>{e&&""!=e?(this._urlOffer=e,a&&a()):alert("Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c url upload")})):
alert("Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c url upload")})},role:function(){return"student"}});aztExam.MonitorStudent=function(){var a;return{getInstance:function(b){cc.log("getInstance student "+a);a||=new aztExam.monitorStudent(b);return a},releaseInst:function(){a=null},inst:function(){return this.getInstance()}}}();aztExam=aztExam||{};
aztExam.monitorTeacher=aztExam.monitor.extend({_imageCaptureWidth:200,_imageCaptureHeight:150,mainViewWidth:1280,mainViewHeight:720,historyWidth:440,userMediaWidth:840,userMediaHeight:472,arrImageIntv:null,isFirstLoad:!0,state:-1,arrUserConn:null,_mouseX:-1,_mouseY:-1,_mouseIntv:-1,_timeOnlineIntv:3E4,_maxUserUpdate:25,_indexStartUpdate:0,_indexEndUpdate:-1,_indexStartShow:0,_numShow:25,currIndexGet:-1,countLoop:0,ctor:function(){this._super();window.addEventListener("resize",()=>{this.onresize()});
document.addEventListener("fullscreenchange",()=>{this.onFullscreenChange()},!1);document.addEventListener("webkitfullscreenchange",()=>{this.onFullscreenChange()},!1);document.addEventListener("mozfullscreenchange",()=>{this.onFullscreenChange()},!1);this.onresize()},start:function(a){this._super(a);this.collectInfo(()=>{0<=this.deviceInfo.osName.toLowerCase().indexOf("window")||0<=this.deviceInfo.osName.toLowerCase().indexOf("mac")?(this._imageCaptureWidth=360,this._imageCaptureHeight=202):(this._imageCaptureHeight=
202,this._imageCaptureWidth=151);this.getTokenForLive(this.options.roomid,b=>{b&&""!=b?(this.options.user.token=b,this.getPublicUpload(this.options.roomid,this.options.user.userid,"offer.txt",(c,e)=>{c&&""!=c?(c=e.indexOf(this.options.roomid),0<=c?(this._urlDownload=e.substr(0,c),this.options.config.useFirestore?this.initFirestore(g=>{this.firebaseApp=g;setTimeout(()=>{this.initShowUser();this.loop()},500)}):setTimeout(()=>{this.initShowUser();this.loop()},500)):alert("Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u download !")):
alert("Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u download !")})):alert("Kh\u00f4ng l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u upload !")});setTimeout(()=>{this.mainHeader.style.display="none";this.onresize()},3E3)})},reset:function(){this._super();this.currIndexGet=-1;this.countLoop=this._indexEndUpdate=this._indexStartUpdate=this._indexStartShow=0;this.isFirstLoad=!0;this.setState(0);this.arrUserConn=[]},onFullscreenChange:function(){this.btFullscreen.innerHTML=document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement?aztExam.svg.iconExitFullscreen:aztExam.svg.iconFullscreen},toggleFullScreen:function(){var a=this.app;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():
a.msRequestFullscreen&&a.msRequestFullscreen()},initUI:function(){this.app=document.createElement("div");this.app.style.width="100%";this.app.style.height="100%";this.app.style.fontFamily="sans-serif";this.app.style.fontSize="20px";this.app.style.overflow="hidden";this.app.style.backgroundColor="#222222";this.mainView=this.findDom(document.createElement("div"));this.mainView.css("width","100%");this.mainView.css("height","100%");this.mainView.css("transform-origin","0% 0%");this.mainView.css("position",
"absolute");this.mainView.classList.add("azt_monitor_mainview");this.mainView.css("background-color","#4c4b4b");this.mainView.css("overflow","hidden");this.mainView.css("display","none");this.app.appendChild(this.mainView);this.userView=this.findDom(document.createElement("div"));this.userView.css("width","100%");this.userView.css("height","100%");this.userView.css("transform-origin","0% 0%");this.userView.css("position","absolute");this.userView.css("overflow","hidden");this.userView.classList.add("azt_monitor_userview");
this.userView.css("background-color","#4c4b4b");this.userView.css("display","none");this.app.appendChild(this.userView);this.divLog=document.createElement("div");this.divLog.style.position="fixed";this.divLog.style.width="100%";this.divLog.style.height="auto";this.divLog.style.bottom="0px";this.initMainView();this.initUserView();this.initUserHistory();this.setState(0)},onresize:function(){var a=window.innerHeight-52;var b=window.innerWidth-96;if(!(0>=a||0>=b)){var c=this.mainViewWidth/this.mainViewHeight<
b/a?a/this.mainViewHeight:b/this.mainViewWidth;a=(a-this.mainViewHeight*c)/2;b=48+(b-this.mainViewWidth*c)/2;this.classMedia.css("transform","scale("+c+")");this.classMedia.css("top",a+"px");this.classMedia.css("left",b+"px");this.btBack.style.top=(window.innerHeight-100)/2+"px";this.btNext.style.left=window.innerWidth-48+"px";this.btNext.style.top=(window.innerHeight-100)/2+"px";this.userHeader.css("width",window.innerWidth-this.historyWidth+"px");this.myMedia.css("width",window.innerWidth-this.historyWidth+
"px");this.app.style.height=window.innerHeight+"px";this.userMediaWidth=window.innerWidth-this.historyWidth-2;this.userMediaHeight=window.innerHeight-60;this.userMedia.css("width",this.userMediaWidth+"px");this.userMedia.css("height",this.userMediaHeight+"px");this.userMedia.css("top","65px");this.listUser.style.height=window.innerHeight-120+"px";this.resizeUserMedia()}},initMainView:function(){this.mainHeader=this.findDom(document.createElement("div"));this.mainHeader.css("width","100%");this.mainHeader.css("height",
"60px");this.mainHeader.css("border-bottom","1px solid black");this.mainHeader.css("position","fixed");this.mainHeader.css("display","none");this.mainHeader.css("top","0px");this.mainHeader.css("background-color","#333434");this.mainView.appendChild(this.mainHeader);this.btViewHistory=this.createButton(180,36,"TH\u00d4NG TIN C\u00c1 NH\u00c2N","#1A84E3",14);this.btViewHistory.css("position","absolute");this.btViewHistory.css("top","12px");this.btViewHistory.css("right","180px");this.btViewHistory.css("cursor",
"pointer");this.btViewHistory.addTouch(b=>{this.removeAllUserMedia();this.showListUser();this.setState(1)});this.mainHeader.appendChild(this.btViewHistory);this.btExit=this.createButton(80,36,"\u0110\u00d3NG","#1A84E3",14);this.btExit.css("position","absolute");this.btExit.css("top","12px");this.btExit.css("left","12px");this.btExit.css("cursor","pointer");this.btExit.addTouch(b=>{window.parent.aztExam.removeMonitorTeacher&&window.parent.aztExam.removeMonitorTeacher()});this.mainHeader.appendChild(this.btExit);
this.mainBottomMenu=this.findDom(document.createElement("div"));this.mainBottomMenu.style.width="100%";this.mainBottomMenu.style.height="50px";this.mainBottomMenu.css("border-top","1px solid black");this.mainBottomMenu.css("position","fixed");this.mainBottomMenu.css("bottom","0px");this.mainBottomMenu.css("background-color","#222222");this.mainView.appendChild(this.mainBottomMenu);this.classMedia=this.findDom(document.createElement("div"));this.classMedia.css("width",this.mainViewWidth+"px");this.classMedia.css("height",
this.mainViewHeight+"px");this.classMedia.css("overflow","hidden");this.classMedia.css("transform-origin","0% 0%");this.classMedia.css("position","absolute");this.classMedia.classList.add("azt_monitor_mainview");this.classMedia.css("background-color","#4c4b4b");this.mainView.appendChild(this.classMedia);this.btClose=this.findDom(document.createElement("div"));this.btClose.css("width","80px");this.btClose.css("height","36px");this.btClose.css("position","absolute");this.btClose.css("right","10px");
this.btClose.css("bottom","7px");this.btClose.css("color","red");this.btClose.css("background","#333434");this.btClose.css("line-height","36px");this.btClose.css("cursor","pointer");this.btClose.css("text-align","center");this.btClose.innerHTML="\u0110\u00d3NG";this.btClose.css("font-size","14px");this.btClose.addTouch(b=>{window.parent.aztExam.removeMonitorTeacher&&window.parent.aztExam.removeMonitorTeacher()});this.mainView.appendChild(this.btClose);this.btClassInfo=this.findDom(document.createElement("div"));
this.btClassInfo.css("width","190px");this.btClassInfo.css("height","36px");this.btClassInfo.css("position","absolute");this.btClassInfo.css("left","10px");this.btClassInfo.css("bottom","7px");this.btClassInfo.css("color","white");this.btClassInfo.css("background","#333434");this.btClassInfo.css("line-height","36px");this.btClassInfo.css("cursor","pointer");this.btClassInfo.css("font-size","12px");this.mainView.appendChild(this.btClassInfo);this.txtClassInfo=document.createElement("div");this.txtClassInfo.style.width=
"150px";this.txtClassInfo.style.lineHeight="36px";this.txtClassInfo.style.marginLeft="40px";this.btClassInfo.appendChild(this.txtClassInfo);var a=document.createElement("div");a.innerHTML=aztExam.svg.iconGroup;a.style.position="absolute";a.style.top="4px";a.style.left="8px";this.btClassInfo.appendChild(a);this.btClassInfo.addTouch(b=>{this.removeAllUserMedia();this.showListUser();this.setState(1)});this.btBack=this.findDom(document.createElement("div"));this.btBack.style.width="48px";this.btBack.style.height=
"auto";this.btBack.style.textAlign="center";this.btBack.style.position="absolute";this.btBack.style.left="0px";this.btBack.style.color="gray";this.btBack.style.fontSize="14px";this.btBack.style.top=(window.innerHeight-100)/2+"px";this.btBack.style.cursor="pointer";this.btBack.style.display="none";this.mainView.appendChild(this.btBack);a=document.createElement("div");a.innerHTML=aztExam.svg.iconLeft;a.style.fill="gray";this.btBack.appendChild(a);this.infoBack=document.createElement("div");this.infoBack.style.width=
"100%";this.infoBack.style.marginTop="-10px";this.btBack.appendChild(this.infoBack);this.btBack.addTouch(b=>{this.backShowUser()});this.btNext=this.findDom(document.createElement("div"));this.btNext.style.width="48px";this.btNext.style.height="auto";this.btNext.style.textAlign="center";this.btNext.style.position="absolute";this.btNext.style.left=window.innerWidth-58+"px";this.btNext.style.top=(window.innerHeight-100)/2+"px";this.btNext.style.color="gray";this.btNext.style.fontSize="14px";this.btNext.style.cursor=
"pointer";this.btNext.style.display="none";this.mainView.appendChild(this.btNext);a=document.createElement("div");a.innerHTML=aztExam.svg.iconLeft;a.style.fill="gray";a.style.transform="scale(-1,1)";this.btNext.appendChild(a);this.infoNext=document.createElement("div");this.infoNext.style.width="100%";this.infoNext.style.marginTop="-10px";this.btNext.appendChild(this.infoNext);this.btNext.addTouch(b=>{this.nextShowUser()});this.btFullscreen=this.findDom(document.createElement("div"));this.btFullscreen.css("cursor",
"pointer");this.btFullscreen.css("position","absolute");this.btFullscreen.css("top","5px");this.btFullscreen.css("right","5px");this.btFullscreen.css("transform","scale(0.6,0.6)");this.btFullscreen.innerHTML=aztExam.svg.iconFullscreen;this.btFullscreen.addTouch(b=>{this.toggleFullScreen()});this.mainView.appendChild(this.btFullscreen)},initUserView:function(){this.userMedia=this.findDom(document.createElement("div"));this.userMedia.css("width",this.userMediaWidth+"px");this.userMedia.css("height",
this.userMediaHeight+"px");this.userMedia.css("transform-origin","0% 0%");this.userMedia.css("background-color","#222222");this.userMedia.css("position","absolute");this.userMedia.css("overflow","hidden");this.userView.appendChild(this.userMedia);this.history=this.findDom(document.createElement("div"));this.history.css("width",this.historyWidth+"px");this.history.css("height","100%");this.history.css("background-color","white");this.history.css("overflow-y","hidden");this.history.css("overflow-x",
"hidden");this.history.css("position","absolute");this.history.css("right","0px");this.history.css("display","block");this.userView.appendChild(this.history);this.listUserView=this.findDom(document.createElement("div"));this.listUserView.css("width",this.historyWidth+"px");this.listUserView.css("height","100%");this.listUserView.css("overflow","hidden");this.listUserView.css("background-color","white");this.listUserView.css("position","absolute");this.listUserView.css("right","0px");this.listUserView.css("display",
"none");this.userView.appendChild(this.listUserView);this.userHeader=this.findDom(document.createElement("div"));this.userHeader.css("width",window.innerWidth-this.historyWidth+"px");this.userHeader.css("height","60px");this.userHeader.css("position","absolute");this.userHeader.css("top","0px");this.userHeader.css("left","0px");this.userHeader.css("background-color","#333434");this.userView.appendChild(this.userHeader);this.btUserViewDone=this.createButton(220,36,"M\u00c0N H\u00ccNH THEO D\u00d5I",
"#1A84E3",14);this.btUserViewDone.css("position","absolute");this.btUserViewDone.css("top","12px");this.btUserViewDone.css("left","12px");this.btUserViewDone.css("cursor","pointer");this.btUserViewDone.addTouch(e=>{this.removeAllUserMedia();this.setState(0)});this.userHeader.appendChild(this.btUserViewDone);this.myMedia=this.findDom(document.createElement("div"));this.myMedia.css("width",window.innerWidth-this.historyWidth+"px");this.myMedia.css("height","80px");this.myMedia.css("position","absolute");
this.myMedia.css("bottom","0px");this.myMedia.css("left","0px");this.myMedia.css("display","flex");this.myMedia.css("flex-direction","row");this.myMedia.css("align-items","center");this.myMedia.css("justify-content","end");this.myMedia.css("background-color","#333434");this.myMedia.css("display","none");this.userView.appendChild(this.myMedia);this.videoReview=this.findDom(document.createElement("video"));this.videoReview.muted=!0;this.videoReview.playsInline=!0;this.videoReview.height=80;this.videoReview.onplay=
()=>{this._hasVideoReviewPlaying=!0;this.videoReview.height=80};this.btMyMedia=this.findDom(document.createElement("div"));this.btMyMedia.css("width","35px");this.btMyMedia.css("height",80);this.btMyMedia.css("margin-left","10px");this.btMyMedia.css("margin-right","6px");this.myMedia.appendChild(this.videoReview);this.myMedia.appendChild(this.btMyMedia);this.btMyCameraOff=this.findDom(document.createElement("div"));this.btMyCameraOff.innerHTML=aztExam.svg.iconCameraOff;this.btMyCameraOff.css("width",
"30px");this.btMyCameraOff.css("height","30px");this.btMyCameraOff.css("fill","#cd1f1f");this.btMyCameraOff.css("color","#cd1f1f");this.btMyCameraOff.css("display","none");this.btMyCameraOff.css("margin-top","5px");this.btMyCameraOff.css("cursor","pointer");this.btMyMedia.appendChild(this.btMyCameraOff);this.btMyCamera=this.findDom(document.createElement("div"));this.btMyCamera.innerHTML=aztExam.svg.iconCamera;this.btMyCamera.css("width","30px");this.btMyCamera.css("height","30px");this.btMyCamera.css("fill",
"#dfd9d9");this.btMyCamera.css("color","#dfd9d9");this.btMyCamera.css("display","block");this.btMyCamera.css("margin-top","5px");this.btMyCamera.css("cursor","pointer");this.btMyMedia.appendChild(this.btMyCamera);this.btMyMicOff=this.findDom(document.createElement("div"));this.btMyMicOff.innerHTML=aztExam.svg.iconMicOff;this.btMyMicOff.css("width","25px");this.btMyMicOff.css("height","25px");this.btMyMicOff.css("fill","#cd1f1f");this.btMyMicOff.css("display","none");this.btMyMicOff.css("margin-top",
"10px");this.btMyMicOff.css("cursor","pointer");this.btMyMedia.appendChild(this.btMyMicOff);this.btMyMic=this.findDom(document.createElement("div"));this.btMyMic.innerHTML=aztExam.svg.iconMic;this.btMyMic.css("width","25px");this.btMyMic.css("height","25px");this.btMyMic.css("fill","#dfd9d9");this.btMyMic.css("display","block");this.btMyMic.css("cursor","pointer");this.btMyMic.css("margin-top","10px");this.btMyMedia.appendChild(this.btMyMic);var a=document.createElement("div");a.style.width="100%";
a.style.height="40px";a.style.padding="10px";a.style.borderBottom="1px solid #CCCCCC";a.style.marginBottom="20px";this.listUserView.appendChild(a);var b=this.createButton(130,36,"TH\u00d4NG TIN","#1A84E3",14);b.style.float="left";b.style.marginTop="4px";b.addTouch(e=>{this.showUserHistory()});a.appendChild(b);var c=document.createElement("div");c.style.width="59%";c.style.height="21px";c.style.borderRadius="8px";c.style.borderColor="#CCCCCC";c.style.backgroundColor="#edeaea";c.style.color="#afaaaa";
c.style.padding="10px";c.style.fontSize="17px";c.style.marginLeft="8px";c.style.float="left";c.innerHTML="T\u00ecm theo t\u00ean ";c.setAttribute("contenteditable",!0);c.setAttribute("contentsearch","");c.addEventListener("input",()=>{cc.log("on txt search change "+c.innerHTML);c.setAttribute("contentsearch",c.innerHTML);this.searchUserListItem(c.innerHTML)});c.addEventListener("focus",()=>{""==c.getAttribute("contentsearch")&&(c.innerHTML="",this.searchUserListItem(c.innerHTML))});c.addEventListener("blur",
()=>{""==c.innerHTML&&(this.searchUserListItem(""),c.innerHTML="T\u00ecm theo t\u00ean ")});a.appendChild(c);this.txtListUserInfo=document.createElement("div");this.txtListUserInfo.style.width="50%";this.txtListUserInfo.style.height="20px";this.txtListUserInfo.innerHTML="";this.txtListUserInfo.style.fontFamily="sans-serif";this.txtListUserInfo.style.fontSize="16px";this.txtListUserInfo.style.paddingLeft="15px";this.listUserView.appendChild(this.txtListUserInfo);this.listUser=document.createElement("div");
this.listUser.style.width="100%";this.listUser.style.overflowX="hidden";this.listUser.style.overflowY="scroll";this.listUser.style.height=window.innerHeight-80+"px";this.listUserView.appendChild(this.listUser);a=document.createElement("div");a.style.width="100%";a.style.height="40px";a.style.padding="10px";a.style.borderBottom="1px solid #CCCCCC";a.style.marginBottom="10px";a.style.display="flex";a.style.flexDirection="row";a.style.justifyContent="start";a.style.alignItems="center";this.history.appendChild(a);
b=this.createButton(130,36,"DANH S\u00c1CH","#1A84E3",14);b.style.marginTop="4px";b.addTouch(e=>{this.showListUser()});a.appendChild(b);b=document.createElement("div");b.style.fontSize="16px";b.innerHTML=aztExam.lang.lbTitleHistory;b.style.fontWeight="bold";b.style.marginTop="4px";b.style.marginLeft="25px";a.appendChild(b)},setState(a){this.state!=a&&(this.state=a,this.mainView.css("display","none"),this.userView.css("display","none"),0==this.state&&this.mainView.css("display","block"),1==this.state&&
this.userView.css("display","block"))},update:function(a){a=(new Date).getTime();this._lastTimeIntv?a>this._lastTimeIntv&&1E3<a-this._lastTimeIntv&&(this.processImageIntv(),this._lastTimeIntv=a):this._lastTimeIntv=a;this._lastTimeGet?a>this._lastTimeGet&&650<a-this._lastTimeGet&&(this.getCurr(),this._lastTimeGet=a):this._lastTimeGet=a;this._running&&window.requestAnimationFrame(b=>{this.update(b)})},getCurr:function(){this.isFirstLoad?(this.currIndexGet++,this.currIndexGet>=this._indexEndUpdate?(this.isFirstLoad=
!1,this.currIndexGet=-9):(cc.log("load index "+this.currIndexGet),this.getCurrUser(this.options.userlist[this.currIndexGet]))):-1>this.currIndexGet?this.currIndexGet++:(this.countLoop++,9>this.countLoop?this.currIndexGet>=this._indexEndUpdate?this.currIndexGet=-1:(this.currIndexGet++,cc.log("load index "+this.currIndexGet),this.getCurrUser(this.options.userlist[this.currIndexGet])):16<=this.countLoop&&(this.countLoop=-1))},getCurrUser:function(a){if(a&&a.userid){var b=new XMLHttpRequest;b.user=a;
b.onreadystatechange=()=>{if(4==b.readyState)if(200==b.status)this.onGetCurrUser(!0,b.responseText,b.user);else this.onGetCurrUser(!1,null,b.user)};cc.log("get user : "+a.userid);b.open("GET",this._urlDownload+this.options.roomid+"/"+a.userid+"/curr.txt?t="+(new Date).getTime());b.send()}},onGetCurrUser:function(a,b,c){if(a){var e=parseInt(b.substr(b.length-10,10));a=b.substr(0,b.length-(10+e));b=b.substr(b.length-(10+e),e);b=JSON.parse(b);c.info=b;c.imgstr=a;c.mainViewItem&&this.bindMainviewItem(c);
c.userListItem&&this.bindUserListItem(c);this.bindUserHistory(c)}else c.lastimeUpdate=(new Date).getTime()},addUser:function(a){if(0<a.length){for(var b=0;b<a.length;b++)a[b].userid&&a[b].username&&this.options.userlist.push(JSON.parse(JSON.stringify(a[b])));this.changeNumShowUser(this._numShow)}},backShowUser:function(){this._indexStartShow>=this._numShow&&(this._indexStartUpdate=this._indexStartShow-=this._numShow,this._indexEndUpdate=this._indexStartUpdate+this._maxUserUpdate<this.options.userlist.length?
this._indexStartUpdate+this._maxUserUpdate:this.options.userlist.length,this.currIndexGet=-1,this.countLoop=0,cc.log("backShowUser :"+this._indexStartShow+":"+this._indexStartUpdate+":"+this._indexEndUpdate),this.changeNumShowUser(this._numShow))},nextShowUser:function(){this._indexStartUpdate=this._indexStartShow=this._indexStartShow+this._numShow<this.options.userlist.length?this._indexStartShow+this._numShow:0;this._indexEndUpdate=this._indexStartUpdate+this._maxUserUpdate<this.options.userlist.length?
this._indexStartUpdate+this._maxUserUpdate:this.options.userlist.length;this.currIndexGet=-1;this.countLoop=0;cc.log("nextShowUser :"+this._indexStartShow+":"+this._indexStartUpdate+":"+this._indexEndUpdate);this.changeNumShowUser(this._numShow)},initShowUser:function(){this._indexStartUpdate=this._indexStartShow=0;this.currIndexGet=-1;this.countLoop=0;this._indexEndUpdate=this.options.userlist.length>this._maxUserUpdate?this._maxUserUpdate:this.options.userlist.length;cc.log("list user : "+JSON.stringify(this.options.userlist));
cc.log("initShowUser "+this._indexStartShow+":"+this._indexStartUpdate+":"+this._indexEndUpdate);this.changeNumShowUser(this._numShow)},changeNumShowUser:function(a){this._numShow=a;this.bindClassMedia();this.initListUser();this.txtClassInfo.innerHTML="Danh s\u00e1ch h\u1ecdc sinh ( "+this.options.userlist.length+" )";a=Math.floor(this.options.userlist.length/this._numShow);a=a==this.options.userlist.length/this._numShow?a:a+1;var b=Math.floor(this._indexStartShow/this._numShow)+1;this.infoNext.innerHTML=
b+" / "+a;this.infoBack.innerHTML=b+" / "+a;this.btBack.style.display="block";this.btNext.style.display="block"},bindClassMedia:function(){var a=this.options.userlist;if(0!=a.length){for(var b=Math.sqrt(this._numShow),c=0,e=Math.floor(this.mainViewWidth/b)-1,g=Math.floor(this.mainViewHeight/Math.sqrt(this._numShow))-1,h=0;h<this.options.userlist.length;h++)this.options.userlist[h].mainViewItem=null;cc.removeAllChildNodes(this.classMedia);for(h=this._indexStartShow;h<this._indexStartShow+this._numShow;h++)if(h<
this.options.userlist.length){this.options.userlist[h].userid||(this.options.userlist[h].userid="-1");this.options.userlist[h].username||(this.options.userlist[h].username="User");var r=this.createMainviewItem(a[h],e,g);r.style.position="absolute";r.style.overflow="hidden";r.style.left=c%b*e+"px";r.style.top=Math.floor(c/b)*g+"px";r.style.cursor="pointer";r.addEventListener("mouseup",v=>{this.addUserMedia(v.currentTarget.user);this.showUserHistory();this.setState(1);v.stopPropagation()});this.classMedia.appendChild(r);
c++}}},processImageIntv:function(){if(0==this.state)for(var a=document.getElementsByClassName("aztExam_image_intv"),b=0;b<a.length;b++){var c=a[b];if(c.hasLoaded){var e=c.image,g=c.info.w,h=c.info.h,r=c.currIdx,v=c.info.numImage,u=c.info.c,M=c.info.r;0<=c.currIdx&&0<v&&(r=r<v-1?r+1:Math.floor(v/2),c.currIdx=r,col=Math.floor(r%u),row=Math.floor(r/M),cc.log("in process imageIntv "+r+":"+col+":"+row+":"+v+":"+u+":"+M),e.style.marginTop=-(row*h)+"px",e.style.marginLeft=-(col*g)+"px",null!=c.info.warning[r.toString()]?
(e=parseInt(c.info.warning[r.toString()]),1<e&&(c.warning.style.backgroundColor="yellow",c.warning.style.display="block"),0==e&&(c.warning.style.backgroundColor="red",c.warning.style.display="block")):c.warning.style.display="none")}}},createMainviewItem:function(a,b,c){var e=document.createElement("div");e.style.border="1px solid black";e.style.backgroundColor="#2e2d2d";e.style.width=b+"px";e.style.height=c+"px";e.user=a;var g=this.findDom(document.createElement("div"));g.css("font-size","14px");
g.css("color","white");g.css("width",b+"px");g.css("height","28px");g.css("display","flex");g.css("align-items","center");g.css("position","absolute");g.css("bottom","0px");g.css("background-color","#4c4949");var h=document.createElement("span");h.style.width=b-70+"px";h.style.paddingLeft="10px";h.style.whiteSpace="nowrap";h.style.overflow="hidden";h.style.color="gray";h.innerHTML=a.username;g.appendChild(h);e.spanName=h;h=this.findDom(document.createElement("div"));h.innerHTML=aztExam.svg.iconRefresh;
h.css("position","absolute");h.css("width","15px");h.css("height","15px");h.css("bottom","8px");h.css("right","30px");h.css("display","block");h.css("cursor","pointer");h.setAttribute("icRefresh",!0);h.addEventListener("mouseup",r=>{this.getCurrUser(r.currentTarget.it.user);r.stopPropagation()});h.it=e;e.icRefresh=h;g.appendChild(h);h=this.findDom(document.createElement("div"));h.css("border-radius","50%");h.css("background-color","gray");h.css("width","6px");h.css("height","6px");h.css("position",
"absolute");h.css("bottom","11px");h.css("right","11px");g.appendChild(h);e.icStatus=h;h=this.findDom(document.createElement("div"));h.innerHTML=aztExam.svg.iconWarning;h.css("position","absolute");h.css("bottom","8px");h.css("right","60px");h.css("display","none");e.icWarning=h;g.appendChild(h);c=22<=c-50?c-50:22;h=this.createCircleAva(a.username,c,"#222222","gray");e.appendChild(h);h.style.position="absolute";h.style.top="12px";h.style.left=(b-c)/2+"px";a.imageIntv||(a.imageIntv=this.createImageIntv());
e.imageIntv=a.imageIntv;e.imageIntv.style.display="none";e.appendChild(e.imageIntv);e.appendChild(g);return a.mainViewItem=e},bindMainviewItem:function(a){if(a&&a.mainViewItem&&a.info&&a.imgstr){var b=a.mainViewItem,c=a.info,e=a.imgstr;a=this.isOnline(c);b.icStatus.style.backgroundColor=a?"#0af50a":"gray";b.spanName.style.color=a?"white":"gray";b.icWarning.style.display=c.isWarning&&a?"block":"none";b.imageIntv.style.display=a?"block":"none";var g=b.imageIntv;if(g.imageTime!=c.time){g=b.imageIntv;
var h=g.image;h.src=e;h.style.marginTop="0px";h.style.marginLeft="0px";g.currIdx=0;g.info=c;g.hasLoaded=!0;g.imageTime=c.time;e=c.w;var r=c.h;g.style.width=e+"px";g.style.height=r+"px";h=parseInt(b.style.width);r=(parseInt(b.style.height)-28)/r;g.style.transform="scale("+r+")";g.style.top="0px";g.style.left=(h-e*r)/2+"px"}b.lastimeUpdate=(new Date).getTime();b.hasLoaded=!0;b.status="updated";b.info=c;b.user.isOnline=a;b.user.info=c}},createImageIntv:function(a){a=this.findDom(document.createElement("div"));
a.style.overflow="hidden";a.style.width=this._imageCaptureWidth+"px";a.style.height=this._imageCaptureHeight+"px";a.classList.add("aztExam_image_intv");a.style.transformOrigin="0% 0%";a.style.position="absolute";a.style.backgroundColor="#2e2d2d";var b=new Image;b.style.position="absolute";a.appendChild(b);var c=document.createElement("div");c.style.position="absolute";c.style.width="100%";c.style.height="100%";c.style.backgroundColor="red";c.style.opacity="0.3";c.style.display="none";a.warning=c;
a.appendChild(c);a.currIdx=-1;a.image=b;a.imageTime=-1;a.info=null;return a},initConn:function(){this.arrConn=[];for(var a=0;4>a;a++)this.arrConn[a]=new aztExam.RTCConnection(this),this.arrConn[a].initConn(this.options.user.userid,"user_"+a,"find_offer"),this.app.appendChild(this.arrConn[a].ui)},addUserMedia:function(a){if(cc.isArray(a)&&0<a.length){for(var b=0;b<a.length>0;b++)this.initUserConn(a[b]);this.history.user=a[0];this.bindUserHistory(a[0]);this.bindUserMedia(this.arrUserConn);this.getListFile(this.options.roomid,
a[0].userid)}else this.initUserConn(a),this.history.user=a,this.bindUserHistory(a),this.bindUserMedia(this.arrUserConn),this.getListFile(this.options.roomid,a.userid)},initUserConn:function(a){for(var b=-1,c=-1,e=0;e<this.arrUserConn.length;e++)this.arrUserConn[e].user==a&&(b=e),!this.arrUserConn[e].isUsed&&0>c&&(c=e);0<=b||(0>c?(b=new aztExam.RTCConnection(this),this.arrUserConn.push(b)):b=this.arrUserConn[c],b.user=a,b.start(this.options.user.userid,a.userid))},removeUserMedia:function(a){for(var b=
-1,c=0;c<this.arrUserConn.length;c++)if(this.arrUserConn[c].user==a){b=c;break}0<=b&&(this.arrUserConn[c].stop(),this.arrUserConn[c].user=null);this.bindUserMedia(this.arrUserConn)},removeAllUserMedia:function(a){for(a=0;a<this.arrUserConn.length;a++)this.arrUserConn[a].stop(),this.arrUserConn[a].user=null;this.bindUserMedia(this.arrUserConn)},resizeUserMedia:function(){var a=this.userMedia.childNodes;if(0<a.length){var b=Math.floor(Math.sqrt(a.length));b=b==Math.sqrt(a.length)?b:b+1;var c=this.userMediaHeight/
b,e=Math.floor(a.length/b);e=e==a.length/b?e:e+1;b=Math.floor((this.userMediaWidth-2)/e);2==a.length&&(b=this.userMediaWidth/2,c=this.userMediaHeight,e=2);for(var g=0;g<a.length;g++){var h=a[g];h.style.width=b+"px";h.style.height=c+"px";h.style.top=Math.floor(g/e)*c+"px";h.style.left=Math.floor(g%e)*b+"px";h.conn.resizeUI(b,c-50);h.ava.style.top=(c-50-parseInt(h.ava.style.height))/2+"px";h.ava.style.left=(b-parseInt(h.ava.style.width))/2+"px"}}},bindUserMedia:function(a){cc.removeAllChildNodes(this.userMedia);
a=[];for(var b=0;b<this.arrUserConn.length;b++)this.arrUserConn[b].isUsed&&a.push(this.arrUserConn[b]);if(0<a.length){b=Math.floor(Math.sqrt(a.length));b=b==Math.sqrt(a.length)?b:b+1;var c=this.userMediaHeight/b,e=Math.floor(a.length/b);e=e==a.length/b?e:e+1;var g=Math.floor((this.userMediaWidth-2)/e);2==a.length&&(g=this.userMediaWidth/2,c=this.userMediaHeight,e=2);for(b=0;b<a.length;b++){var h=this.createUserMediaItem(a[b],g,c);h.style.position="absolute";h.style.width=g+"px";h.style.height=c+"px";
h.style.top=Math.floor(b/e)*c+"px";h.style.left=Math.floor(b%e)*g+"px";h.conn=a[b];this.userMedia.appendChild(h)}}},createUserMediaItem:function(a,b,c){var e=document.createElement("div");e.style.border="1px solid black";e.style.backgroundColor="#2e2d2d";e.style.width=b+"px";e.style.height=c+"px";e.addEventListener("mouseup",v=>{this.history.user=v.currentTarget.conn.user;this.bindUserHistory(v.currentTarget.conn.user);this.showUserHistory();v.stopPropagation()});e.conn=a;var g=this.findDom(document.createElement("div"));
g.css("font-size","16px");g.css("color","white");g.css("width","100%");g.css("height","50px");g.css("display","flex");g.css("align-items","center");g.css("position","absolute");g.css("bottom","0px");g.css("background-color","#222222");var h=document.createElement("span");h.style.width=b-70+"px";h.style.paddingLeft="10px";h.style.whiteSpace="nowrap";h.style.overflow="hidden";h.style.color="gray";h.innerHTML=a.user.username;g.appendChild(h);e.spanName=h;h=this.findDom(document.createElement("div"));
h.innerHTML=aztExam.svg.iconClose;h.css("position","absolute");h.css("width","30px");h.css("height","30px");h.css("bottom","18px");h.css("right","10px");h.css("display","block");h.css("cursor","pointer");h.conn=a;h.addEventListener("mouseup",v=>{this.removeUserMedia(v.currentTarget.conn.user);v.stopPropagation()});g.appendChild(h);h=22<=c-50?c-50:22;h=200<h?200:h;var r=this.createCircleAva(a.user.username,h,"#222222","gray");e.ava=r;e.appendChild(r);r.style.position="absolute";r.style.top=(c-50-h)/
2+"px";r.style.left=(b-h)/2+"px";a.ui.style.position="absolute";a.resizeUI(b,c-50);e.appendChild(a.ui);e.appendChild(g);return e},showListUser:function(){this.listUserView.style.display="block";this.history.style.display="none";this.searchUserListItem("")},showUserHistory:function(){this.listUserView.style.display="none";this.history.style.display="block"},initListUser:function(){for(var a=0;a<this.options.userlist.length;a++)this.options.userlist[a].listUserItem=null;cc.removeAllChildNodes(this.listUser);
for(a=this._indexStartUpdate;a<this._indexEndUpdate;a++)if(a<this.options.userlist.length){var b=this.createUserListItem(this.options.userlist[a]);this.options.userlist[a].listUserItem=b;this.listUser.appendChild(b)}},createUserListItem:function(a){if(a){var b=this.findDom(document.createElement("div"));b.style.width=this.historyWidth+"px";b.style.height="60px";b.style.display="flex";b.style.flexDirection="row";b.style.alignItems="center";b.style.paddingLeft="10px";b.style.cursor="pointer";a.userListItem=
b;b.addTouch(h=>{this.addUserMedia(h.target.user)});b.addTouchMove(h=>{h.target.style.backgroundColor="#EEEEEE"});b.addTouchOut(h=>{h.target.style.backgroundColor="white"});var c="#F47373 #697689 #37D67A #2CCCE4 #555555 #dce775 #ff8a65 #ba68c8".split(" ");c=this.createCircleAva(a.username,50,c[Math.floor(Math.random()*(c.length-1))],"white");b.ava=c;c.style.pointerEvents="none";c.style.opacity=.5;b.appendChild(c);c=document.createElement("div");c.style.width=this.historyWidth-50+"px";c.style.height=
"100%";c.style.display="flex";c.style.justifyContent="center";c.style.paddingLeft="10px";c.style.flexDirection="column";c.style.pointerEvents="none";b.appendChild(c);var e=document.createElement("div");e.style.color="gray";e.style.fontSize="18px";e.style.fontFamily="sans-serif";e.style.display="flex";e.style.flexDirection="row";b.txtname=e;c.appendChild(e);var g=document.createElement("div");g.style.width="260px";g.innerHTML=a.username;e.appendChild(g);g=this.findDom(document.createElement("div"));
g.style.width="20px";g.style.height="20px";g.style.fill="#979494";g.style.display="none";g.innerHTML=aztExam.svg.iconCamera;b.icCam=g;e.appendChild(g);g=this.findDom(document.createElement("div"));g.style.width="20px";g.style.height="20px";g.style.marginLeft="10px";g.style.fill="#979494";g.style.display="none";g.innerHTML=aztExam.svg.iconMic;b.icMic=g;e.appendChild(g);g=this.findDom(document.createElement("div"));g.style.width="20px";g.style.height="20px";g.style.marginLeft="10px";g.style.display=
"none";g.innerHTML=aztExam.svg.iconWarning;b.icWarning=g;e.appendChild(g);e=document.createElement("div");e.style.width="1005";e.style.display="flex";e.style.flexDirection="row";e.style.alignItems="center";e.style.justifyContent="start";c.appendChild(e);c=this.findDom(document.createElement("div"));c.css("border-radius","50%");c.css("background-color","gray");c.css("width","10px");c.css("height","10px");c.css("margin-right","4px");c.style.marginTop="5px";b.icStatus=c;e.appendChild(c);c=document.createElement("div");
c.style.color="gray";c.style.fontSize="14px";c.style.fontFamily="sans-serif";c.style.marginTop="5px";c.innerHTML="Offline";b.txtinfo=c;e.appendChild(c);b.user=a;return b}},createCircleAva:function(a,b,c,e){a||="";a=a.trim();var g=this.findDom(document.createElement("div"));g.css("border-radius","50%");g.css("background-color",c);g.css("width",b+"px");g.css("height",b+"px");g.css("display","flex");g.css("align-items","center");g.css("justify-content","center");g.css("color",e);g.css("font-size",(b-
10)/2+"px");a=a.split(" ");g.innerHTML=a[a.length-1].substr(0,2).toUpperCase();return g},bindUserListItem:function(a){if(a&&a.userListItem&&a.info){var b=a.userListItem;a=a.info;var c=(new Date).getTime(),e=Math.abs(c-a.time);c=(new Date(a.time)).toLocaleString();c=e<this._timeOnlineIntv?"Online":"Offline . "+c;e=this.isOnline(a);b.txtinfo.innerHTML=c;e?(b.ava.style.opacity=1,b.txtname.style.color="black",b.icStatus.style.backgroundColor="#0af50a",b.txtinfo.style.opacity=1,b.txtname.style.opacity=
1,b.icStatus.style.opacity=1,b.icCam.style.display="block",b.icMic.style.display="block",b.icCam.innerHTML=a.deviceInfo.isWebsiteHasWebcamPermissions?aztExam.svg.iconCamera:aztExam.svg.iconCameraOff,b.icMic.innerHTML=a.deviceInfo.isWebsiteHasMicrophonePermissions?aztExam.svg.iconMic:aztExam.svg.iconMicOff,b.icWarning.style.display=a.isWarning?"block":"none"):(b.ava.style.opacity=.6,b.txtname.style.color="gray",b.icStatus.style.backgroundColor="gray",b.txtinfo.style.opacity=.6,b.txtname.style.opacity=
.6,b.icStatus.style.opacity=.6,b.icCam.style.display="none",b.icMic.style.display="none",b.icWarning.style.display="none");this.txtListUserInfo.style.display="none"}},searchUserListItem:function(a){for(var b=this.listUser.childNodes,c=0;c<b.length;c++)""==a.trim()?b[c].style.display="flex":0<=b[c].user.username.toLowerCase().indexOf(a.trim().toLowerCase())?b[c].style.display="flex":b[c].style.display="none"},initUserHistory:function(){this.userInfo=document.createElement("div");this.userInfo.style.width=
"100%";this.userInfo.style.height="auto";this.userInfo.style.marginTop="15px";this.userInfo.style.marginLeft="15px";this.userInfo.style.marginBottom="35px";this.userInfo.style.fontSize="16px";this.userInfo.style.lineHeight="25px";this.history.appendChild(this.userInfo);this.userHistory=document.createElement("div");this.userHistory.style.width="100%";this.userHistory.style.height=window.innerHeight-330+"px";this.userHistory.style.overflowY="scroll";this.userHistory.style.overflowX="hidden";this.userHistory.style.paddingTop=
"10px";this.history.appendChild(this.userHistory)},bindUserHistory:function(a){if(this.history.user==a)if(a&&a.info){var b="<b>T\u00ean : </b>"+a.username+"<br/>";b+="<b>H\u1ec7 \u0111i\u1ec1u h\u00e0nh : </b>"+a.info.deviceInfo.osName+"_"+a.info.deviceInfo.osVersion+"<br/>";b+="<b>Tr\u00ecnh duy\u1ec7t :  </b>"+a.info.deviceInfo.browser.name+"_"+a.info.deviceInfo.browser.version+"<br/>";b+="<b>Tr\u1ea1ng th\u00e1i : </b>"+(this.isOnline(a.info)?"Online":"Offline")+"<br/>";b+="<b>Webcam : </b>"+(a.info.deviceInfo.hasWebcam?
"C\u00f3":"Kh\u00f4ng")+"<br/>";b+="<b>C\u00f3 c\u1ea5p quy\u1ec1n webcam : </b>"+(a.info.deviceInfo.isWebsiteHasWebcamPermissions?"C\u00f3":"Kh\u00f4ng")+"<br/>";b+="<b>Microphone : </b>"+(a.info.deviceInfo.hasMicrophone?"C\u00f3":"Kh\u00f4ng")+"<br/>";b+="<b>C\u00f3 c\u1ea5p quy\u1ec1n microphone : </b>"+(a.info.deviceInfo.isWebsiteHasMicrophonePermissions?"C\u00f3":"Kh\u00f4ng")+"<br/>";b+="<b>C\u1eadp nh\u1eadt : </b>"+(new Date(a.info.time)).toLocaleString()+"<br/>";this.userInfo.innerHTML=b}else this.userInfo.innerHTML=
"\u0110ang l\u1ea5y d\u1eef li\u1ec7u ...."},createUserHistoryItem:function(a){a=this.findDom(document.createElement("div"));a.style.width="100%";a.style.height="100px";a.style.marginLeft="20px";a.style.position="relative";a.style.cursor="pointer";a.style.borderLeft="2px solid green";a.addTouch(c=>{});a.addTouchMove(c=>{c.target.style.backgroundColor="#EEEEEE"});a.addTouchOut(c=>{c.target.style.backgroundColor="white"});var b=document.createElement("div");b.style.borderRadius="50%";b.style.width=
"10px";b.style.height="10px";b.style.backgroundColor="green";b.style.border="1px solid #888888";b.style.position="absolute";b.style.bottom="0px";b.style.left="-7px";b.style.pointerEvents="none";a.appendChild(b);b=document.createElement("div");b.innerHTML="2021-11-11 09:11:11 AM";b.style.fontSize="14px";b.style.position="absolute";b.style.bottom="0px";b.style.left="15px";b.style.pointerEvents="none";a.appendChild(b);b=this.findDom(document.createElement("div"));b.style.width="100px";b.style.height=
"60px";b.style.display="flex";b.style.flexDirection="column";b.style.justifyContent="center";b.style.alignItems="center";b.style.position="absolute";b.style.left="35px";b.style.top="25px";b.style.fontSize="12px";b.innerHTML=aztExam.svg.iconWarning+"6 C\u1ea3nh b\u00e1o";b.style.pointerEvents="none";a.appendChild(b);return a},isOnline:function(a){return a&&a.time&&(new Date).getTime()-a.time<this._timeOnlineIntv?!0:!1},role:function(){return"teacher"}});
aztExam.MonitorTeacher=function(){var a;return{getInstance:function(b){a||=new aztExam.monitorTeacher(b);return a},releaseInst:function(){a=null},inst:function(){return this.getInstance()}}}();
